import{c as ae,u as fe,r as l,j as e,B as w,X as qe,a as oe,s as k,b as M,d as Ga,e as ct,f as Gt,A as Ua,P as ve,g as he,h as S,D as Ut,C as Ka,i as re,k as Kt,l as Va,m as Vt,n as qa,o as qt,p as Bt,R as Ba,q as Ht,t as J,v as Ha}from"./index-BdAXvNPF.js";import{u as Wa,a as Se,b as Qa,c as Ya,d as Xa,e as le,f as Fe,g as Pe,A as rt,h as nt,i as ot,j as Za,k as it,l as Ja,m as er,n as tr,o as sr,p as ar,U as rr,S as nr,H as or}from"./avatar-DVtzO2oZ.js";import{I as $,c as Wt,R as lr,a as cr,L as G,s as Be,o as ir,n as Re,l as dr}from"./types-CF352nbN.js";import{C as He,S as V,a as q,b as B,c as H,d as z,P as We,h as Qt,u as Yt,F as Xt,R as Zt,e as dt,f as ut,g as Ot,i as ur,D as Ft}from"./DreamTeamSelector-DtSNxFJD.js";import{u as Qe,a as mr,b as mt,c as xr,d as Jt,e as pr,f as fr,g as hr,h as xt,i as gr,j as yr,k as jr}from"./usePlayerStats-DzxUnD5y.js";import{T as es}from"./trophy-DlSqbHMA.js";import{u as ts,a as Nr,b as vr}from"./useTourTeams-uu-QVeZB.js";import{u as br,a as ke}from"./index-B4dSCxLh.js";import{u as wr}from"./useTourDreamTeamsBySeason-DLprrpLq.js";import{C as ue,a as me,b as xe,c as pe}from"./card-CyZjmtNt.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _r=ae("ArrowRightLeft",[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cr=ae("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mr=ae("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sr=ae("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pr=ae("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tr=ae("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=ae("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dr=ae("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=ae("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=ae("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Er=ae("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);function Rr(){const{isAdmin:t}=fe(),{data:a=[]}=Wa(),{data:s,isLoading:r}=Se(),n=Qa(),o=Ya(),c=Xa(),[i,m]=l.useState(!1),[p,u]=l.useState(""),x=()=>{u((s==null?void 0:s.name)??""),m(!0)},f=()=>{s&&p.trim()&&o.mutate({id:s.id,name:p.trim()}),m(!1)},y=()=>{m(!1),u("")},g=()=>{n.mutate("ÐÐ¾Ð²Ñ‹Ð¹ ÑÐµÐ·Ð¾Ð½")},_=b=>{b!==(s==null?void 0:s.id)&&c.mutate(b)};return r?e.jsx("div",{className:"h-10 bg-secondary/50 rounded animate-pulse"}):s?e.jsxs("div",{className:"flex items-center gap-3 py-2 flex-wrap",children:[i?e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx($,{value:p,onChange:b=>u(b.target.value),className:"bg-secondary border-border text-xl font-bold max-w-xs",autoFocus:!0}),e.jsx(w,{size:"icon",variant:"ghost",onClick:f,disabled:o.isPending,children:e.jsx(He,{className:"w-4 h-4 text-green-500"})}),e.jsx(w,{size:"icon",variant:"ghost",onClick:y,children:e.jsx(qe,{className:"w-4 h-4 text-destructive"})})]}):e.jsxs(e.Fragment,{children:[t&&a.length>1?e.jsxs(V,{value:s.id,onValueChange:_,children:[e.jsx(q,{className:"w-auto min-w-[200px] text-2xl font-bold text-primary border-none bg-transparent h-auto py-0 px-0 focus:ring-0",children:e.jsx(B,{})}),e.jsx(H,{children:a.map(b=>e.jsxs(z,{value:b.id,children:[b.name," ",b.is_current&&"(Ñ‚ÐµÐºÑƒÑ‰Ð¸Ð¹)"]},b.id))})]}):e.jsx("h2",{className:"text-2xl font-bold text-primary",children:s.name}),t&&e.jsx(w,{size:"icon",variant:"ghost",onClick:x,children:e.jsx(We,{className:"w-4 h-4"})})]}),t&&!i&&e.jsxs(w,{variant:"outline",size:"sm",onClick:g,disabled:n.isPending,className:"ml-auto",children:[e.jsx(Me,{className:"w-4 h-4 mr-1"}),"ÐÐ¾Ð²Ñ‹Ð¹ ÑÐµÐ·Ð¾Ð½"]})]}):e.jsxs("div",{className:"flex items-center justify-center gap-4 py-4 bg-secondary/30 rounded-lg",children:[e.jsx("p",{className:"text-muted-foreground",children:"Ð¡ÐµÐ·Ð¾Ð½ Ð½Ðµ ÑÐ¾Ð·Ð´Ð°Ð½"}),t&&e.jsxs(w,{onClick:g,disabled:n.isPending,children:[e.jsx(Me,{className:"w-4 h-4 mr-2"}),"Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ ÑÐµÐ·Ð¾Ð½"]})]})}function Ir({selectedTourId:t,onTourChange:a}){const{isAdmin:s}=fe(),{data:r}=Se(),{data:n=[]}=Qe((r==null?void 0:r.id)??null),o=mr(),c=()=>{r&&o.mutate(r.id,{onSuccess:i=>{a(i.id)}})};return r?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(V,{value:t??"",onValueChange:i=>a(i||null),children:[e.jsx(q,{className:"w-[180px] bg-secondary border-border",children:e.jsx(B,{placeholder:"Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ñ‚ÑƒÑ€"})}),e.jsx(H,{children:n.map(i=>e.jsxs(z,{value:i.id,children:["Ð¢ÑƒÑ€ ",i.number]},i.id))})]}),s&&e.jsxs(w,{size:"sm",onClick:c,disabled:o.isPending,className:"bg-primary text-primary-foreground hover:bg-primary/90",children:[e.jsx(Me,{className:"w-4 h-4 mr-1"}),"ÐÐ¾Ð²Ñ‹Ð¹ Ñ‚ÑƒÑ€"]})]}):null}function kr(){const t=oe();return le({mutationFn:async({tourId:a,playerId:s})=>{const{error:r}=await k.from("tours").update({mvp_player_id:s}).eq("id",a);if(r)throw r},onSuccess:()=>{t.invalidateQueries({queryKey:["tours"]}),M.success("MVP Ñ‚ÑƒÑ€Ð° Ð¾Ð±Ð½Ð¾Ð²Ð»Ñ‘Ð½")},onError:a=>{M.error(a.message)}})}function Ar({tourId:t,mvpPlayerId:a,tourNumber:s}){const{isAdmin:r}=fe(),{data:n=[]}=Fe(),{data:o=[]}=Pe(),c=kr(),[i,m]=l.useState(!1),[p,u]=l.useState(""),x=a?n.find(P=>P.id===a):null,f=x?o.find(P=>P.id===x.team_id):null,y=P=>{switch(P){case"red":return"text-team-red";case"blue":return"text-team-blue";case"green":return"text-team-green";case"black":return"text-foreground";default:return"text-muted-foreground"}},g=()=>{u(a||"none"),m(!0)},_=()=>{t&&c.mutate({tourId:t,playerId:p==="none"?null:p||null}),m(!1)},b=()=>{u(a||""),m(!1)};return t?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 px-6 mvp-card rounded-2xl",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(es,{className:"w-7 h-7 text-accent trophy-glow"}),e.jsxs("span",{className:"text-xl font-display font-bold text-foreground tracking-wide",children:["MVP Ð¢ÑƒÑ€Ð° ",s]}),r&&!i&&e.jsx(w,{size:"icon",variant:"ghost",onClick:g,className:"h-7 w-7",children:e.jsx(We,{className:"w-4 h-4"})}),i&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(w,{size:"icon",variant:"ghost",onClick:_,disabled:c.isPending,className:"h-7 w-7",children:e.jsx(He,{className:"w-4 h-4 text-green-500"})}),e.jsx(w,{size:"icon",variant:"ghost",onClick:b,className:"h-7 w-7",children:e.jsx(qe,{className:"w-4 h-4 text-destructive"})})]})]}),i?e.jsxs(V,{value:p,onValueChange:u,children:[e.jsx(q,{className:"w-[250px]",children:e.jsx(B,{placeholder:"Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ MVP"})}),e.jsxs(H,{children:[e.jsx(z,{value:"none",children:"ÐÐµ Ð²Ñ‹Ð±Ñ€Ð°Ð½"}),n.map(P=>{const U=o.find(T=>T.id===P.team_id);return e.jsx(z,{value:P.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(rt,{className:"h-6 w-6",children:[e.jsx(nt,{src:P.photo_url,alt:P.name}),e.jsx(ot,{className:"text-xs",children:P.name[0]})]}),e.jsx("span",{children:P.name}),U&&e.jsxs("span",{className:`text-xs ${y(U.color)}`,children:["(",U.name,")"]})]})},P.id)})]})]}):x?e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsxs(rt,{className:"h-28 w-28 border-4 border-accent/60 shadow-xl",children:[e.jsx(nt,{src:x.photo_url,alt:x.name}),e.jsx(ot,{className:"text-3xl bg-accent/20 font-display",children:x.name[0]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-display font-bold text-foreground tracking-wide",children:x.name}),f&&e.jsx("p",{className:`text-sm font-medium ${y(f.color)}`,children:f.name})]})]}):e.jsx("p",{className:"text-muted-foreground text-sm",children:"MVP Ð½Ðµ Ð²Ñ‹Ð±Ñ€Ð°Ð½"})]}):null}var lt=["Enter"," "],Or=["ArrowDown","PageUp","Home"],as=["ArrowUp","PageDown","End"],Fr=[...Or,...as],$r={ltr:[...lt,"ArrowRight"],rtl:[...lt,"ArrowLeft"]},Lr={ltr:["ArrowLeft"],rtl:["ArrowRight"]},$e="Menu",[Ae,zr,Gr]=Ga($e),[be,rs]=ct($e,[Gr,Gt,Wt]),Ye=Gt(),ns=Wt(),[Ur,we]=be($e),[Kr,Le]=be($e),os=t=>{const{__scopeMenu:a,open:s=!1,children:r,dir:n,onOpenChange:o,modal:c=!0}=t,i=Ye(a),[m,p]=l.useState(null),u=l.useRef(!1),x=Kt(o),f=br(n);return l.useEffect(()=>{const y=()=>{u.current=!0,document.addEventListener("pointerdown",g,{capture:!0,once:!0}),document.addEventListener("pointermove",g,{capture:!0,once:!0})},g=()=>u.current=!1;return document.addEventListener("keydown",y,{capture:!0}),()=>{document.removeEventListener("keydown",y,{capture:!0}),document.removeEventListener("pointerdown",g,{capture:!0}),document.removeEventListener("pointermove",g,{capture:!0})}},[]),e.jsx(Ba,{...i,children:e.jsx(Ur,{scope:a,open:s,onOpenChange:x,content:m,onContentChange:p,children:e.jsx(Kr,{scope:a,onClose:l.useCallback(()=>x(!1),[x]),isUsingKeyboardRef:u,dir:f,modal:c,children:r})})})};os.displayName=$e;var Vr="MenuAnchor",pt=l.forwardRef((t,a)=>{const{__scopeMenu:s,...r}=t,n=Ye(s);return e.jsx(Ua,{...n,...r,ref:a})});pt.displayName=Vr;var ft="MenuPortal",[qr,ls]=be(ft,{forceMount:void 0}),cs=t=>{const{__scopeMenu:a,forceMount:s,children:r,container:n}=t,o=we(ft,a);return e.jsx(qr,{scope:a,forceMount:s,children:e.jsx(ve,{present:s||o.open,children:e.jsx(qt,{asChild:!0,container:n,children:r})})})};cs.displayName=ft;var ee="MenuContent",[Br,ht]=be(ee),is=l.forwardRef((t,a)=>{const s=ls(ee,t.__scopeMenu),{forceMount:r=s.forceMount,...n}=t,o=we(ee,t.__scopeMenu),c=Le(ee,t.__scopeMenu);return e.jsx(Ae.Provider,{scope:t.__scopeMenu,children:e.jsx(ve,{present:r||o.open,children:e.jsx(Ae.Slot,{scope:t.__scopeMenu,children:c.modal?e.jsx(Hr,{...n,ref:a}):e.jsx(Wr,{...n,ref:a})})})})}),Hr=l.forwardRef((t,a)=>{const s=we(ee,t.__scopeMenu),r=l.useRef(null),n=he(a,r);return l.useEffect(()=>{const o=r.current;if(o)return Qt(o)},[]),e.jsx(gt,{...t,ref:n,trapFocus:s.open,disableOutsidePointerEvents:s.open,disableOutsideScroll:!0,onFocusOutside:S(t.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>s.onOpenChange(!1)})}),Wr=l.forwardRef((t,a)=>{const s=we(ee,t.__scopeMenu);return e.jsx(gt,{...t,ref:a,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>s.onOpenChange(!1)})}),Qr=Bt("MenuContent.ScrollLock"),gt=l.forwardRef((t,a)=>{const{__scopeMenu:s,loop:r=!1,trapFocus:n,onOpenAutoFocus:o,onCloseAutoFocus:c,disableOutsidePointerEvents:i,onEntryFocus:m,onEscapeKeyDown:p,onPointerDownOutside:u,onFocusOutside:x,onInteractOutside:f,onDismiss:y,disableOutsideScroll:g,..._}=t,b=we(ee,s),P=Le(ee,s),U=Ye(s),T=ns(s),L=zr(s),[N,C]=l.useState(null),v=l.useRef(null),I=he(a,v,b.onContentChange),D=l.useRef(0),K=l.useRef(""),Q=l.useRef(0),O=l.useRef(null),A=l.useRef("right"),X=l.useRef(0),ge=g?Zt:l.Fragment,ye=g?{as:Qr,allowPinchZoom:!0}:void 0,h=j=>{var se,Te;const E=K.current+j,Z=L().filter(Y=>!Y.disabled),te=document.activeElement,ce=(se=Z.find(Y=>Y.ref.current===te))==null?void 0:se.textValue,_e=Z.map(Y=>Y.textValue),je=ln(_e,E,ce),ie=(Te=Z.find(Y=>Y.textValue===je))==null?void 0:Te.ref.current;(function Y(De){K.current=De,window.clearTimeout(D.current),De!==""&&(D.current=window.setTimeout(()=>Y(""),1e3))})(E),ie&&setTimeout(()=>ie.focus())};l.useEffect(()=>()=>window.clearTimeout(D.current),[]),Yt();const F=l.useCallback(j=>{var Z,te;return A.current===((Z=O.current)==null?void 0:Z.side)&&dn(j,(te=O.current)==null?void 0:te.area)},[]);return e.jsx(Br,{scope:s,searchRef:K,onItemEnter:l.useCallback(j=>{F(j)&&j.preventDefault()},[F]),onItemLeave:l.useCallback(j=>{var E;F(j)||((E=v.current)==null||E.focus(),C(null))},[F]),onTriggerLeave:l.useCallback(j=>{F(j)&&j.preventDefault()},[F]),pointerGraceTimerRef:Q,onPointerGraceIntentChange:l.useCallback(j=>{O.current=j},[]),children:e.jsx(ge,{...ye,children:e.jsx(Xt,{asChild:!0,trapped:n,onMountAutoFocus:S(o,j=>{var E;j.preventDefault(),(E=v.current)==null||E.focus({preventScroll:!0})}),onUnmountAutoFocus:c,children:e.jsx(Ut,{asChild:!0,disableOutsidePointerEvents:i,onEscapeKeyDown:p,onPointerDownOutside:u,onFocusOutside:x,onInteractOutside:f,onDismiss:y,children:e.jsx(lr,{asChild:!0,...T,dir:P.dir,orientation:"vertical",loop:r,currentTabStopId:N,onCurrentTabStopIdChange:C,onEntryFocus:S(m,j=>{P.isUsingKeyboardRef.current||j.preventDefault()}),preventScrollOnEntryFocus:!0,children:e.jsx(Ka,{role:"menu","aria-orientation":"vertical","data-state":Cs(b.open),"data-radix-menu-content":"",dir:P.dir,...U,..._,ref:I,style:{outline:"none",..._.style},onKeyDown:S(_.onKeyDown,j=>{const Z=j.target.closest("[data-radix-menu-content]")===j.currentTarget,te=j.ctrlKey||j.altKey||j.metaKey,ce=j.key.length===1;Z&&(j.key==="Tab"&&j.preventDefault(),!te&&ce&&h(j.key));const _e=v.current;if(j.target!==_e||!Fr.includes(j.key))return;j.preventDefault();const ie=L().filter(se=>!se.disabled).map(se=>se.ref.current);as.includes(j.key)&&ie.reverse(),nn(ie)}),onBlur:S(t.onBlur,j=>{j.currentTarget.contains(j.target)||(window.clearTimeout(D.current),K.current="")}),onPointerMove:S(t.onPointerMove,Oe(j=>{const E=j.target,Z=X.current!==j.clientX;if(j.currentTarget.contains(E)&&Z){const te=j.clientX>X.current?"right":"left";A.current=te,X.current=j.clientX}}))})})})})})})});is.displayName=ee;var Yr="MenuGroup",yt=l.forwardRef((t,a)=>{const{__scopeMenu:s,...r}=t;return e.jsx(re.div,{role:"group",...r,ref:a})});yt.displayName=Yr;var Xr="MenuLabel",ds=l.forwardRef((t,a)=>{const{__scopeMenu:s,...r}=t;return e.jsx(re.div,{...r,ref:a})});ds.displayName=Xr;var Ue="MenuItem",$t="menu.itemSelect",Xe=l.forwardRef((t,a)=>{const{disabled:s=!1,onSelect:r,...n}=t,o=l.useRef(null),c=Le(Ue,t.__scopeMenu),i=ht(Ue,t.__scopeMenu),m=he(a,o),p=l.useRef(!1),u=()=>{const x=o.current;if(!s&&x){const f=new CustomEvent($t,{bubbles:!0,cancelable:!0});x.addEventListener($t,y=>r==null?void 0:r(y),{once:!0}),qa(x,f),f.defaultPrevented?p.current=!1:c.onClose()}};return e.jsx(us,{...n,ref:m,disabled:s,onClick:S(t.onClick,u),onPointerDown:x=>{var f;(f=t.onPointerDown)==null||f.call(t,x),p.current=!0},onPointerUp:S(t.onPointerUp,x=>{var f;p.current||(f=x.currentTarget)==null||f.click()}),onKeyDown:S(t.onKeyDown,x=>{const f=i.searchRef.current!=="";s||f&&x.key===" "||lt.includes(x.key)&&(x.currentTarget.click(),x.preventDefault())})})});Xe.displayName=Ue;var us=l.forwardRef((t,a)=>{const{__scopeMenu:s,disabled:r=!1,textValue:n,...o}=t,c=ht(Ue,s),i=ns(s),m=l.useRef(null),p=he(a,m),[u,x]=l.useState(!1),[f,y]=l.useState("");return l.useEffect(()=>{const g=m.current;g&&y((g.textContent??"").trim())},[o.children]),e.jsx(Ae.ItemSlot,{scope:s,disabled:r,textValue:n??f,children:e.jsx(cr,{asChild:!0,...i,focusable:!r,children:e.jsx(re.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...o,ref:p,onPointerMove:S(t.onPointerMove,Oe(g=>{r?c.onItemLeave(g):(c.onItemEnter(g),g.defaultPrevented||g.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:S(t.onPointerLeave,Oe(g=>c.onItemLeave(g))),onFocus:S(t.onFocus,()=>x(!0)),onBlur:S(t.onBlur,()=>x(!1))})})})}),Zr="MenuCheckboxItem",ms=l.forwardRef((t,a)=>{const{checked:s=!1,onCheckedChange:r,...n}=t;return e.jsx(gs,{scope:t.__scopeMenu,checked:s,children:e.jsx(Xe,{role:"menuitemcheckbox","aria-checked":Ke(s)?"mixed":s,...n,ref:a,"data-state":Nt(s),onSelect:S(n.onSelect,()=>r==null?void 0:r(Ke(s)?!0:!s),{checkForDefaultPrevented:!1})})})});ms.displayName=Zr;var xs="MenuRadioGroup",[Jr,en]=be(xs,{value:void 0,onValueChange:()=>{}}),ps=l.forwardRef((t,a)=>{const{value:s,onValueChange:r,...n}=t,o=Kt(r);return e.jsx(Jr,{scope:t.__scopeMenu,value:s,onValueChange:o,children:e.jsx(yt,{...n,ref:a})})});ps.displayName=xs;var fs="MenuRadioItem",hs=l.forwardRef((t,a)=>{const{value:s,...r}=t,n=en(fs,t.__scopeMenu),o=s===n.value;return e.jsx(gs,{scope:t.__scopeMenu,checked:o,children:e.jsx(Xe,{role:"menuitemradio","aria-checked":o,...r,ref:a,"data-state":Nt(o),onSelect:S(r.onSelect,()=>{var c;return(c=n.onValueChange)==null?void 0:c.call(n,s)},{checkForDefaultPrevented:!1})})})});hs.displayName=fs;var jt="MenuItemIndicator",[gs,tn]=be(jt,{checked:!1}),ys=l.forwardRef((t,a)=>{const{__scopeMenu:s,forceMount:r,...n}=t,o=tn(jt,s);return e.jsx(ve,{present:r||Ke(o.checked)||o.checked===!0,children:e.jsx(re.span,{...n,ref:a,"data-state":Nt(o.checked)})})});ys.displayName=jt;var sn="MenuSeparator",js=l.forwardRef((t,a)=>{const{__scopeMenu:s,...r}=t;return e.jsx(re.div,{role:"separator","aria-orientation":"horizontal",...r,ref:a})});js.displayName=sn;var an="MenuArrow",Ns=l.forwardRef((t,a)=>{const{__scopeMenu:s,...r}=t,n=Ye(s);return e.jsx(Va,{...n,...r,ref:a})});Ns.displayName=an;var rn="MenuSub",[Nl,vs]=be(rn),Ie="MenuSubTrigger",bs=l.forwardRef((t,a)=>{const s=we(Ie,t.__scopeMenu),r=Le(Ie,t.__scopeMenu),n=vs(Ie,t.__scopeMenu),o=ht(Ie,t.__scopeMenu),c=l.useRef(null),{pointerGraceTimerRef:i,onPointerGraceIntentChange:m}=o,p={__scopeMenu:t.__scopeMenu},u=l.useCallback(()=>{c.current&&window.clearTimeout(c.current),c.current=null},[]);return l.useEffect(()=>u,[u]),l.useEffect(()=>{const x=i.current;return()=>{window.clearTimeout(x),m(null)}},[i,m]),e.jsx(pt,{asChild:!0,...p,children:e.jsx(us,{id:n.triggerId,"aria-haspopup":"menu","aria-expanded":s.open,"aria-controls":n.contentId,"data-state":Cs(s.open),...t,ref:Vt(a,n.onTriggerChange),onClick:x=>{var f;(f=t.onClick)==null||f.call(t,x),!(t.disabled||x.defaultPrevented)&&(x.currentTarget.focus(),s.open||s.onOpenChange(!0))},onPointerMove:S(t.onPointerMove,Oe(x=>{o.onItemEnter(x),!x.defaultPrevented&&!t.disabled&&!s.open&&!c.current&&(o.onPointerGraceIntentChange(null),c.current=window.setTimeout(()=>{s.onOpenChange(!0),u()},100))})),onPointerLeave:S(t.onPointerLeave,Oe(x=>{var y,g;u();const f=(y=s.content)==null?void 0:y.getBoundingClientRect();if(f){const _=(g=s.content)==null?void 0:g.dataset.side,b=_==="right",P=b?-5:5,U=f[b?"left":"right"],T=f[b?"right":"left"];o.onPointerGraceIntentChange({area:[{x:x.clientX+P,y:x.clientY},{x:U,y:f.top},{x:T,y:f.top},{x:T,y:f.bottom},{x:U,y:f.bottom}],side:_}),window.clearTimeout(i.current),i.current=window.setTimeout(()=>o.onPointerGraceIntentChange(null),300)}else{if(o.onTriggerLeave(x),x.defaultPrevented)return;o.onPointerGraceIntentChange(null)}})),onKeyDown:S(t.onKeyDown,x=>{var y;const f=o.searchRef.current!=="";t.disabled||f&&x.key===" "||$r[r.dir].includes(x.key)&&(s.onOpenChange(!0),(y=s.content)==null||y.focus(),x.preventDefault())})})})});bs.displayName=Ie;var ws="MenuSubContent",_s=l.forwardRef((t,a)=>{const s=ls(ee,t.__scopeMenu),{forceMount:r=s.forceMount,...n}=t,o=we(ee,t.__scopeMenu),c=Le(ee,t.__scopeMenu),i=vs(ws,t.__scopeMenu),m=l.useRef(null),p=he(a,m);return e.jsx(Ae.Provider,{scope:t.__scopeMenu,children:e.jsx(ve,{present:r||o.open,children:e.jsx(Ae.Slot,{scope:t.__scopeMenu,children:e.jsx(gt,{id:i.contentId,"aria-labelledby":i.triggerId,...n,ref:p,align:"start",side:c.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var x;c.isUsingKeyboardRef.current&&((x=m.current)==null||x.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:S(t.onFocusOutside,u=>{u.target!==i.trigger&&o.onOpenChange(!1)}),onEscapeKeyDown:S(t.onEscapeKeyDown,u=>{c.onClose(),u.preventDefault()}),onKeyDown:S(t.onKeyDown,u=>{var y;const x=u.currentTarget.contains(u.target),f=Lr[c.dir].includes(u.key);x&&f&&(o.onOpenChange(!1),(y=i.trigger)==null||y.focus(),u.preventDefault())})})})})})});_s.displayName=ws;function Cs(t){return t?"open":"closed"}function Ke(t){return t==="indeterminate"}function Nt(t){return Ke(t)?"indeterminate":t?"checked":"unchecked"}function nn(t){const a=document.activeElement;for(const s of t)if(s===a||(s.focus(),document.activeElement!==a))return}function on(t,a){return t.map((s,r)=>t[(a+r)%t.length])}function ln(t,a,s){const n=a.length>1&&Array.from(a).every(p=>p===a[0])?a[0]:a,o=s?t.indexOf(s):-1;let c=on(t,Math.max(o,0));n.length===1&&(c=c.filter(p=>p!==s));const m=c.find(p=>p.toLowerCase().startsWith(n.toLowerCase()));return m!==s?m:void 0}function cn(t,a){const{x:s,y:r}=t;let n=!1;for(let o=0,c=a.length-1;o<a.length;c=o++){const i=a[o],m=a[c],p=i.x,u=i.y,x=m.x,f=m.y;u>r!=f>r&&s<(x-p)*(r-u)/(f-u)+p&&(n=!n)}return n}function dn(t,a){if(!a)return!1;const s={x:t.clientX,y:t.clientY};return cn(s,a)}function Oe(t){return a=>a.pointerType==="mouse"?t(a):void 0}var un=os,mn=pt,xn=cs,pn=is,fn=yt,hn=ds,gn=Xe,yn=ms,jn=ps,Nn=hs,vn=ys,bn=js,wn=Ns,_n=bs,Cn=_s,Ze="DropdownMenu",[Mn,vl]=ct(Ze,[rs]),W=rs(),[Sn,Ms]=Mn(Ze),Ss=t=>{const{__scopeDropdownMenu:a,children:s,dir:r,open:n,defaultOpen:o,onOpenChange:c,modal:i=!0}=t,m=W(a),p=l.useRef(null),[u,x]=Ht({prop:n,defaultProp:o??!1,onChange:c,caller:Ze});return e.jsx(Sn,{scope:a,triggerId:ke(),triggerRef:p,contentId:ke(),open:u,onOpenChange:x,onOpenToggle:l.useCallback(()=>x(f=>!f),[x]),modal:i,children:e.jsx(un,{...m,open:u,onOpenChange:x,dir:r,modal:i,children:s})})};Ss.displayName=Ze;var Ps="DropdownMenuTrigger",Ts=l.forwardRef((t,a)=>{const{__scopeDropdownMenu:s,disabled:r=!1,...n}=t,o=Ms(Ps,s),c=W(s);return e.jsx(mn,{asChild:!0,...c,children:e.jsx(re.button,{type:"button",id:o.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":o.open?o.contentId:void 0,"data-state":o.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...n,ref:Vt(a,o.triggerRef),onPointerDown:S(t.onPointerDown,i=>{!r&&i.button===0&&i.ctrlKey===!1&&(o.onOpenToggle(),o.open||i.preventDefault())}),onKeyDown:S(t.onKeyDown,i=>{r||(["Enter"," "].includes(i.key)&&o.onOpenToggle(),i.key==="ArrowDown"&&o.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(i.key)&&i.preventDefault())})})})});Ts.displayName=Ps;var Pn="DropdownMenuPortal",Ds=t=>{const{__scopeDropdownMenu:a,...s}=t,r=W(a);return e.jsx(xn,{...r,...s})};Ds.displayName=Pn;var Es="DropdownMenuContent",Rs=l.forwardRef((t,a)=>{const{__scopeDropdownMenu:s,...r}=t,n=Ms(Es,s),o=W(s),c=l.useRef(!1);return e.jsx(pn,{id:n.contentId,"aria-labelledby":n.triggerId,...o,...r,ref:a,onCloseAutoFocus:S(t.onCloseAutoFocus,i=>{var m;c.current||(m=n.triggerRef.current)==null||m.focus(),c.current=!1,i.preventDefault()}),onInteractOutside:S(t.onInteractOutside,i=>{const m=i.detail.originalEvent,p=m.button===0&&m.ctrlKey===!0,u=m.button===2||p;(!n.modal||u)&&(c.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Rs.displayName=Es;var Tn="DropdownMenuGroup",Dn=l.forwardRef((t,a)=>{const{__scopeDropdownMenu:s,...r}=t,n=W(s);return e.jsx(fn,{...n,...r,ref:a})});Dn.displayName=Tn;var En="DropdownMenuLabel",Is=l.forwardRef((t,a)=>{const{__scopeDropdownMenu:s,...r}=t,n=W(s);return e.jsx(hn,{...n,...r,ref:a})});Is.displayName=En;var Rn="DropdownMenuItem",ks=l.forwardRef((t,a)=>{const{__scopeDropdownMenu:s,...r}=t,n=W(s);return e.jsx(gn,{...n,...r,ref:a})});ks.displayName=Rn;var In="DropdownMenuCheckboxItem",As=l.forwardRef((t,a)=>{const{__scopeDropdownMenu:s,...r}=t,n=W(s);return e.jsx(yn,{...n,...r,ref:a})});As.displayName=In;var kn="DropdownMenuRadioGroup",An=l.forwardRef((t,a)=>{const{__scopeDropdownMenu:s,...r}=t,n=W(s);return e.jsx(jn,{...n,...r,ref:a})});An.displayName=kn;var On="DropdownMenuRadioItem",Os=l.forwardRef((t,a)=>{const{__scopeDropdownMenu:s,...r}=t,n=W(s);return e.jsx(Nn,{...n,...r,ref:a})});Os.displayName=On;var Fn="DropdownMenuItemIndicator",Fs=l.forwardRef((t,a)=>{const{__scopeDropdownMenu:s,...r}=t,n=W(s);return e.jsx(vn,{...n,...r,ref:a})});Fs.displayName=Fn;var $n="DropdownMenuSeparator",$s=l.forwardRef((t,a)=>{const{__scopeDropdownMenu:s,...r}=t,n=W(s);return e.jsx(bn,{...n,...r,ref:a})});$s.displayName=$n;var Ln="DropdownMenuArrow",zn=l.forwardRef((t,a)=>{const{__scopeDropdownMenu:s,...r}=t,n=W(s);return e.jsx(wn,{...n,...r,ref:a})});zn.displayName=Ln;var Gn="DropdownMenuSubTrigger",Ls=l.forwardRef((t,a)=>{const{__scopeDropdownMenu:s,...r}=t,n=W(s);return e.jsx(_n,{...n,...r,ref:a})});Ls.displayName=Gn;var Un="DropdownMenuSubContent",zs=l.forwardRef((t,a)=>{const{__scopeDropdownMenu:s,...r}=t,n=W(s);return e.jsx(Cn,{...n,...r,ref:a,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});zs.displayName=Un;var Kn=Ss,Vn=Ts,qn=Ds,Gs=Rs,Us=Is,Ks=ks,Vs=As,qs=Os,Bs=Fs,Hs=$s,Ws=Ls,Qs=zs;const Bn=Kn,Hn=Vn,Wn=l.forwardRef(({className:t,inset:a,children:s,...r},n)=>e.jsxs(Ws,{ref:n,className:J("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent focus:bg-accent",a&&"pl-8",t),...r,children:[s,e.jsx(Sr,{className:"ml-auto h-4 w-4"})]}));Wn.displayName=Ws.displayName;const Qn=l.forwardRef(({className:t,...a},s)=>e.jsx(Qs,{ref:s,className:J("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...a}));Qn.displayName=Qs.displayName;const Ys=l.forwardRef(({className:t,sideOffset:a=4,...s},r)=>e.jsx(qn,{children:e.jsx(Gs,{ref:r,sideOffset:a,className:J("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...s})}));Ys.displayName=Gs.displayName;const Xs=l.forwardRef(({className:t,inset:a,...s},r)=>e.jsx(Ks,{ref:r,className:J("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",a&&"pl-8",t),...s}));Xs.displayName=Ks.displayName;const Yn=l.forwardRef(({className:t,children:a,checked:s,...r},n)=>e.jsxs(Vs,{ref:n,className:J("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),checked:s,...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Bs,{children:e.jsx(He,{className:"h-4 w-4"})})}),a]}));Yn.displayName=Vs.displayName;const Xn=l.forwardRef(({className:t,children:a,...s},r)=>e.jsxs(qs,{ref:r,className:J("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),...s,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Bs,{children:e.jsx(Pr,{className:"h-2 w-2 fill-current"})})}),a]}));Xn.displayName=qs.displayName;const Zn=l.forwardRef(({className:t,inset:a,...s},r)=>e.jsx(Us,{ref:r,className:J("px-2 py-1.5 text-sm font-semibold",a&&"pl-8",t),...s}));Zn.displayName=Us.displayName;const Jn=l.forwardRef(({className:t,...a},s)=>e.jsx(Hs,{ref:s,className:J("-mx-1 my-1 h-px bg-muted",t),...a}));Jn.displayName=Hs.displayName;function eo(t,a,s,r,n){let o=0,c=0,i=0,m=0,p=0;return n.forEach(u=>{u.home_team_id===t?(m+=u.home_score,p+=u.away_score,u.home_score>u.away_score?o++:u.home_score===u.away_score?c++:i++):u.away_team_id===t&&(m+=u.away_score,p+=u.home_score,u.away_score>u.home_score?o++:u.away_score===u.home_score?c++:i++)}),{teamId:t,teamName:a,color:s,tourTeamId:r,played:o+c+i,won:o,drawn:c,lost:i,goalsFor:m,goalsAgainst:p,goalDiff:m-p,points:o*3+c}}const to=[{value:"red",label:"ÐšÑ€Ð°ÑÐ½Ñ‹Ð¹",className:"bg-team-red"},{value:"blue",label:"Ð¡Ð¸Ð½Ð¸Ð¹",className:"bg-team-blue"},{value:"green",label:"Ð—ÐµÐ»Ñ‘Ð½Ñ‹Ð¹",className:"bg-team-green"},{value:"black",label:"Ð§Ñ‘Ñ€Ð½Ñ‹Ð¹",className:"bg-team-black"}];function so({tourId:t}){const{isAdmin:a}=fe(),{data:s=[]}=ts(t),{data:r=[]}=Pe(),{data:n=[]}=mt(t),o=Za(),c=l.useMemo(()=>s.map(m=>{const p=r.find(x=>x.id===m.team_id),u=(p==null?void 0:p.color)??"black";return eo(m.team_id,m.team.name,u,m.id,n)}).sort((m,p)=>p.points-m.points||p.goalDiff-m.goalDiff),[s,n,r]),i=m=>{switch(m){case"red":return"bg-team-red px-2 py-0.5 rounded";case"blue":return"bg-team-blue px-2 py-0.5 rounded";case"green":return"bg-team-green px-2 py-0.5 rounded";case"black":return"bg-team-black text-foreground px-2 py-0.5 rounded";default:return""}};return t?e.jsxs("div",{className:"stat-card",children:[e.jsx("h2",{className:"text-xl font-display font-bold text-foreground tracking-wide mb-4",children:"Ð¢Ð°Ð±Ð»Ð¸Ñ†Ð° Ñ‚ÑƒÑ€Ð°"}),c.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"Ð”Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹ Ð² Ñ‚ÑƒÑ€"}):e.jsx("div",{className:"overflow-x-auto football-table",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-border text-muted-foreground",children:[e.jsx("th",{className:"text-left py-3 px-3 font-display tracking-wide",children:"ÐšÐ¾Ð¼Ð°Ð½Ð´Ð°"}),e.jsx("th",{className:"text-center py-3 px-1 font-display",children:"Ð˜"}),e.jsx("th",{className:"text-center py-3 px-1 font-display",children:"Ð’"}),e.jsx("th",{className:"text-center py-3 px-1 font-display",children:"Ð"}),e.jsx("th",{className:"text-center py-3 px-1 font-display",children:"ÐŸ"}),e.jsx("th",{className:"text-center py-3 px-1 font-display",children:"Ð“Ð—"}),e.jsx("th",{className:"text-center py-3 px-1 font-display",children:"Ð“ÐŸ"}),e.jsx("th",{className:"text-center py-3 px-1 font-display",children:"Ð Ð°Ð·Ð½"}),e.jsx("th",{className:"text-center py-3 px-1 font-display text-primary",children:"ÐžÑ‡ÐºÐ¸"}),a&&e.jsx("th",{className:"w-8"})]})}),e.jsx("tbody",{children:c.map(m=>e.jsxs("tr",{className:"border-b border-border/50 transition-colors",children:[e.jsx("td",{className:"py-2 px-2 font-medium",children:e.jsx("span",{className:i(m.color),children:m.teamName})}),e.jsx("td",{className:"text-center py-2 px-1 font-mono",children:m.played}),e.jsx("td",{className:"text-center py-2 px-1 font-mono",children:m.won}),e.jsx("td",{className:"text-center py-2 px-1 font-mono",children:m.drawn}),e.jsx("td",{className:"text-center py-2 px-1 font-mono",children:m.lost}),e.jsx("td",{className:"text-center py-2 px-1 font-mono",children:m.goalsFor}),e.jsx("td",{className:"text-center py-2 px-1 font-mono",children:m.goalsAgainst}),e.jsxs("td",{className:"text-center py-2 px-1 font-mono",children:[m.goalDiff>0?"+":"",m.goalDiff]}),e.jsx("td",{className:"text-center py-2 px-1 font-mono font-bold text-primary",children:m.points}),a&&e.jsx("td",{className:"py-2 px-1",children:e.jsxs(Bn,{children:[e.jsx(Hn,{asChild:!0,children:e.jsx(w,{variant:"ghost",size:"icon",className:"h-6 w-6",children:e.jsx(Tr,{className:"w-3 h-3"})})}),e.jsx(Ys,{children:to.map(p=>e.jsxs(Xs,{onClick:()=>o.mutate({id:m.teamId,color:p.value}),className:"gap-2",children:[e.jsx("div",{className:`w-4 h-4 rounded ${p.className}`}),p.label]},p.value))})]})})]},m.teamId))})]})})]}):e.jsxs("div",{className:"stat-card",children:[e.jsx("h2",{className:"text-xl font-display font-bold text-foreground tracking-wide mb-4",children:"Ð¢Ð°Ð±Ð»Ð¸Ñ†Ð° Ñ‚ÑƒÑ€Ð°"}),e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"Ð¡Ð¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ Ð¸Ð»Ð¸ Ð²Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ñ‚ÑƒÑ€"})]})}var Je="Dialog",[Zs,bl]=ct(Je),[ao,ne]=Zs(Je),Js=t=>{const{__scopeDialog:a,children:s,open:r,defaultOpen:n,onOpenChange:o,modal:c=!0}=t,i=l.useRef(null),m=l.useRef(null),[p,u]=Ht({prop:r,defaultProp:n??!1,onChange:o,caller:Je});return e.jsx(ao,{scope:a,triggerRef:i,contentRef:m,contentId:ke(),titleId:ke(),descriptionId:ke(),open:p,onOpenChange:u,onOpenToggle:l.useCallback(()=>u(x=>!x),[u]),modal:c,children:s})};Js.displayName=Je;var ea="DialogTrigger",ro=l.forwardRef((t,a)=>{const{__scopeDialog:s,...r}=t,n=ne(ea,s),o=he(a,n.triggerRef);return e.jsx(re.button,{type:"button","aria-haspopup":"dialog","aria-expanded":n.open,"aria-controls":n.contentId,"data-state":wt(n.open),...r,ref:o,onClick:S(t.onClick,n.onOpenToggle)})});ro.displayName=ea;var vt="DialogPortal",[no,ta]=Zs(vt,{forceMount:void 0}),sa=t=>{const{__scopeDialog:a,forceMount:s,children:r,container:n}=t,o=ne(vt,a);return e.jsx(no,{scope:a,forceMount:s,children:l.Children.map(r,c=>e.jsx(ve,{present:s||o.open,children:e.jsx(qt,{asChild:!0,container:n,children:c})}))})};sa.displayName=vt;var Ve="DialogOverlay",aa=l.forwardRef((t,a)=>{const s=ta(Ve,t.__scopeDialog),{forceMount:r=s.forceMount,...n}=t,o=ne(Ve,t.__scopeDialog);return o.modal?e.jsx(ve,{present:r||o.open,children:e.jsx(lo,{...n,ref:a})}):null});aa.displayName=Ve;var oo=Bt("DialogOverlay.RemoveScroll"),lo=l.forwardRef((t,a)=>{const{__scopeDialog:s,...r}=t,n=ne(Ve,s);return e.jsx(Zt,{as:oo,allowPinchZoom:!0,shards:[n.contentRef],children:e.jsx(re.div,{"data-state":wt(n.open),...r,ref:a,style:{pointerEvents:"auto",...r.style}})})}),Ne="DialogContent",ra=l.forwardRef((t,a)=>{const s=ta(Ne,t.__scopeDialog),{forceMount:r=s.forceMount,...n}=t,o=ne(Ne,t.__scopeDialog);return e.jsx(ve,{present:r||o.open,children:o.modal?e.jsx(co,{...n,ref:a}):e.jsx(io,{...n,ref:a})})});ra.displayName=Ne;var co=l.forwardRef((t,a)=>{const s=ne(Ne,t.__scopeDialog),r=l.useRef(null),n=he(a,s.contentRef,r);return l.useEffect(()=>{const o=r.current;if(o)return Qt(o)},[]),e.jsx(na,{...t,ref:n,trapFocus:s.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:S(t.onCloseAutoFocus,o=>{var c;o.preventDefault(),(c=s.triggerRef.current)==null||c.focus()}),onPointerDownOutside:S(t.onPointerDownOutside,o=>{const c=o.detail.originalEvent,i=c.button===0&&c.ctrlKey===!0;(c.button===2||i)&&o.preventDefault()}),onFocusOutside:S(t.onFocusOutside,o=>o.preventDefault())})}),io=l.forwardRef((t,a)=>{const s=ne(Ne,t.__scopeDialog),r=l.useRef(!1),n=l.useRef(!1);return e.jsx(na,{...t,ref:a,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var c,i;(c=t.onCloseAutoFocus)==null||c.call(t,o),o.defaultPrevented||(r.current||(i=s.triggerRef.current)==null||i.focus(),o.preventDefault()),r.current=!1,n.current=!1},onInteractOutside:o=>{var m,p;(m=t.onInteractOutside)==null||m.call(t,o),o.defaultPrevented||(r.current=!0,o.detail.originalEvent.type==="pointerdown"&&(n.current=!0));const c=o.target;((p=s.triggerRef.current)==null?void 0:p.contains(c))&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&n.current&&o.preventDefault()}})}),na=l.forwardRef((t,a)=>{const{__scopeDialog:s,trapFocus:r,onOpenAutoFocus:n,onCloseAutoFocus:o,...c}=t,i=ne(Ne,s),m=l.useRef(null),p=he(a,m);return Yt(),e.jsxs(e.Fragment,{children:[e.jsx(Xt,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:n,onUnmountAutoFocus:o,children:e.jsx(Ut,{role:"dialog",id:i.contentId,"aria-describedby":i.descriptionId,"aria-labelledby":i.titleId,"data-state":wt(i.open),...c,ref:p,onDismiss:()=>i.onOpenChange(!1)})}),e.jsxs(e.Fragment,{children:[e.jsx(uo,{titleId:i.titleId}),e.jsx(xo,{contentRef:m,descriptionId:i.descriptionId})]})]})}),bt="DialogTitle",oa=l.forwardRef((t,a)=>{const{__scopeDialog:s,...r}=t,n=ne(bt,s);return e.jsx(re.h2,{id:n.titleId,...r,ref:a})});oa.displayName=bt;var la="DialogDescription",ca=l.forwardRef((t,a)=>{const{__scopeDialog:s,...r}=t,n=ne(la,s);return e.jsx(re.p,{id:n.descriptionId,...r,ref:a})});ca.displayName=la;var ia="DialogClose",da=l.forwardRef((t,a)=>{const{__scopeDialog:s,...r}=t,n=ne(ia,s);return e.jsx(re.button,{type:"button",...r,ref:a,onClick:S(t.onClick,()=>n.onOpenChange(!1))})});da.displayName=ia;function wt(t){return t?"open":"closed"}var ua="DialogTitleWarning",[wl,ma]=Ha(ua,{contentName:Ne,titleName:bt,docsSlug:"dialog"}),uo=({titleId:t})=>{const a=ma(ua),s=`\`${a.contentName}\` requires a \`${a.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${a.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${a.docsSlug}`;return l.useEffect(()=>{t&&(document.getElementById(t)||console.error(s))},[s,t]),null},mo="DialogDescriptionWarning",xo=({contentRef:t,descriptionId:a})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${ma(mo).contentName}}.`;return l.useEffect(()=>{var o;const n=(o=t.current)==null?void 0:o.getAttribute("aria-describedby");a&&n&&(document.getElementById(a)||console.warn(r))},[r,t,a]),null},po=Js,fo=sa,xa=aa,pa=ra,fa=oa,ha=ca,ho=da;const go=po,yo=fo,ga=l.forwardRef(({className:t,...a},s)=>e.jsx(xa,{ref:s,className:J("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...a}));ga.displayName=xa.displayName;const ya=l.forwardRef(({className:t,children:a,...s},r)=>e.jsxs(yo,{children:[e.jsx(ga,{}),e.jsxs(pa,{ref:r,className:J("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...s,children:[a,e.jsxs(ho,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[e.jsx(qe,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));ya.displayName=pa.displayName;const ja=({className:t,...a})=>e.jsx("div",{className:J("flex flex-col space-y-1.5 text-center sm:text-left",t),...a});ja.displayName="DialogHeader";const Na=l.forwardRef(({className:t,...a},s)=>e.jsx(fa,{ref:s,className:J("text-lg font-semibold leading-none tracking-tight",t),...a}));Na.displayName=fa.displayName;const jo=l.forwardRef(({className:t,...a},s)=>e.jsx(ha,{ref:s,className:J("text-sm text-muted-foreground",t),...a}));jo.displayName=ha.displayName;function va(){const t=oe();return le({mutationFn:async a=>{const{data:s,error:r}=await k.from("matches").select("home_team_id, away_team_id, tour_id").eq("id",a).single();if(r)throw r;const{data:n,error:o}=await k.from("player_stats").select("goals, own_goals, player_id, player:players(team_id)").eq("match_id",a);if(o)throw o;const{data:c,error:i}=await k.from("tour_player_substitutions").select("original_player_id, substitute_player_id, original_player:players!tour_player_substitutions_original_player_id_fkey(team_id)").eq("tour_id",s.tour_id);if(i)throw i;const m=new Map;c==null||c.forEach(f=>{var y;(y=f.original_player)!=null&&y.team_id&&m.set(f.substitute_player_id,f.original_player.team_id)});let p=0,u=0;n==null||n.forEach(f=>{var b;const y=f.goals||0,g=f.own_goals||0;let _=(b=f.player)==null?void 0:b.team_id;_||(_=m.get(f.player_id)),_===s.home_team_id?(p+=y,u+=g):_===s.away_team_id&&(u+=y,p+=g)});const{error:x}=await k.from("matches").update({home_score:p,away_score:u}).eq("id",a);if(x)throw x;return{homeScore:p,awayScore:u}},onSuccess:()=>{t.invalidateQueries({queryKey:["matches"]}),t.invalidateQueries({queryKey:["all-matches"]})}})}function No({match:t,isOpen:a,onClose:s}){const{isAdmin:r}=fe(),{data:n=[],refetch:o}=xr((t==null?void 0:t.id)??null),{data:c=[]}=Fe(),i=Jt(),m=pr(),p=fr(),u=va(),[x,f]=l.useState(null),[y,g]=l.useState({goals:0,own_goals:0,assists:0,yellow_cards:0,red_cards:0}),[_,b]=l.useState(!1),[P,U]=l.useState(""),[T,L]=l.useState({goals:0,own_goals:0,assists:0,yellow_cards:0,red_cards:0});if(!t)return null;const N=[t.home_team_id,t.away_team_id],C=c.filter(h=>N.includes(h.team_id)),v=n.map(h=>h.player_id),I=C.filter(h=>!v.includes(h.id)),D=n.filter(h=>{var F;return((F=h.player)==null?void 0:F.team_id)===t.home_team_id}),K=n.filter(h=>{var F;return((F=h.player)==null?void 0:F.team_id)===t.away_team_id}),Q=h=>{f(h.id),g({goals:h.goals||0,own_goals:h.own_goals||0,assists:h.assists||0,yellow_cards:h.yellow_cards||0,red_cards:h.red_cards||0})},O=async()=>{!x||!t||(await m.mutateAsync({id:x,...y}),await u.mutateAsync(t.id),f(null),o())},A=async h=>{t&&(await p.mutateAsync(h),await u.mutateAsync(t.id),o())},X=async()=>{if(!P||!t){M.error("Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð¸Ð³Ñ€Ð¾ÐºÐ°");return}await i.mutateAsync({match_id:t.id,player_id:P,goals:T.goals,own_goals:T.own_goals,assists:T.assists,yellow_cards:T.yellow_cards,red_cards:T.red_cards}),await u.mutateAsync(t.id),b(!1),U(""),L({goals:0,own_goals:0,assists:0,yellow_cards:0,red_cards:0}),o()},ge=(h,F)=>{const j=h.player;return j?F&&r?e.jsxs("div",{className:"flex items-center gap-2 py-2 px-3 bg-secondary/50 rounded-lg",children:[e.jsx("span",{className:"flex-1 font-medium text-sm",children:j.name}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(G,{className:"text-[10px] text-muted-foreground",children:"âš½"}),e.jsx($,{type:"number",min:"0",max:"2",value:y.goals,onChange:E=>g({...y,goals:parseInt(E.target.value)||0}),className:"w-12 h-7 text-xs text-center p-1"})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(G,{className:"text-[10px] text-muted-foreground",children:"ðŸ”„"}),e.jsx($,{type:"number",min:"0",max:"2",value:y.own_goals,onChange:E=>g({...y,own_goals:parseInt(E.target.value)||0}),className:"w-12 h-7 text-xs text-center p-1"})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(G,{className:"text-[10px] text-muted-foreground",children:"ðŸ‘Ÿ"}),e.jsx($,{type:"number",min:"0",value:y.assists,onChange:E=>g({...y,assists:parseInt(E.target.value)||0}),className:"w-12 h-7 text-xs text-center p-1"})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(G,{className:"text-[10px] text-muted-foreground",children:"ðŸŸ¨"}),e.jsx($,{type:"number",min:"0",value:y.yellow_cards,onChange:E=>g({...y,yellow_cards:parseInt(E.target.value)||0}),className:"w-12 h-7 text-xs text-center p-1"})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(G,{className:"text-[10px] text-muted-foreground",children:"ðŸŸ¥"}),e.jsx($,{type:"number",min:"0",value:y.red_cards,onChange:E=>g({...y,red_cards:parseInt(E.target.value)||0}),className:"w-12 h-7 text-xs text-center p-1"})]})]}),e.jsx(w,{size:"sm",variant:"ghost",onClick:O,className:"h-7 w-7 p-0 text-green-500",children:e.jsx(He,{className:"w-4 h-4"})}),e.jsx(w,{size:"sm",variant:"ghost",onClick:()=>f(null),className:"h-7 w-7 p-0 text-muted-foreground",children:e.jsx(qe,{className:"w-4 h-4"})})]},h.id):e.jsxs("div",{className:"flex items-center gap-2 py-2 px-3 bg-secondary/30 rounded-lg hover:bg-secondary/50 transition-colors",children:[e.jsx("span",{className:"flex-1 font-medium text-sm",children:j.name}),e.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[h.goals>0&&e.jsxs("span",{className:"flex items-center gap-1",children:["âš½ ",h.goals]}),h.own_goals>0&&e.jsxs("span",{className:"flex items-center gap-1 text-destructive",children:["ðŸ”„ ",h.own_goals]}),h.assists>0&&e.jsxs("span",{className:"flex items-center gap-1",children:["ðŸ‘Ÿ ",h.assists]}),h.yellow_cards>0&&e.jsxs("span",{children:["ðŸŸ¨ ",h.yellow_cards]}),h.red_cards>0&&e.jsxs("span",{children:["ðŸŸ¥ ",h.red_cards]})]}),r&&e.jsxs("div",{className:"flex gap-1",children:[e.jsx(w,{size:"sm",variant:"ghost",onClick:()=>Q(h),className:"h-7 w-7 p-0",children:e.jsx(We,{className:"w-3 h-3"})}),e.jsx(w,{size:"sm",variant:"ghost",onClick:()=>A(h.id),className:"h-7 w-7 p-0 text-destructive",children:e.jsx(Ce,{className:"w-3 h-3"})})]})]},h.id):null},ye=(h,F,j)=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-display text-sm font-semibold text-foreground/80",children:F}),h.length===0?e.jsx("p",{className:"text-xs text-muted-foreground py-2",children:"ÐÐµÑ‚ ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ¸"}):e.jsx("div",{className:"space-y-1",children:h.map(E=>ge(E,x===E.id))})]});return e.jsx(go,{open:a,onOpenChange:s,children:e.jsxs(ya,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(ja,{children:e.jsx(Na,{className:"text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-4",children:[e.jsx("span",{className:"font-display text-lg",children:t.home_team.name}),e.jsxs("span",{className:"font-display font-bold text-2xl match-score px-4 py-1 rounded-lg bg-secondary/50",children:[t.home_score," : ",t.away_score]}),e.jsx("span",{className:"font-display text-lg",children:t.away_team.name})]})})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mt-4",children:[ye(D,t.home_team.name,t.home_team_id),ye(K,t.away_team.name,t.away_team_id)]}),r&&e.jsx("div",{className:"mt-6 pt-4 border-t border-border",children:_?e.jsxs("div",{className:"space-y-3",children:[e.jsxs(V,{value:P,onValueChange:U,children:[e.jsx(q,{children:e.jsx(B,{placeholder:"Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð¸Ð³Ñ€Ð¾ÐºÐ°"})}),e.jsx(H,{children:I.map(h=>e.jsx(z,{value:h.id,children:h.name},h.id))})]}),e.jsxs("div",{className:"grid grid-cols-5 gap-2",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(G,{className:"text-xs text-muted-foreground mb-1",children:"âš½ Ð“Ð¾Ð»Ñ‹"}),e.jsx($,{type:"number",min:"0",max:"2",value:T.goals,onChange:h=>L({...T,goals:parseInt(h.target.value)||0}),className:"text-center"})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(G,{className:"text-xs text-muted-foreground mb-1",children:"ðŸ”„ ÐÐ²Ñ‚Ð¾Ð³Ð¾Ð»"}),e.jsx($,{type:"number",min:"0",max:"2",value:T.own_goals,onChange:h=>L({...T,own_goals:parseInt(h.target.value)||0}),className:"text-center"})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(G,{className:"text-xs text-muted-foreground mb-1",children:"ðŸ‘Ÿ ÐŸÐ°ÑÑ‹"}),e.jsx($,{type:"number",min:"0",value:T.assists,onChange:h=>L({...T,assists:parseInt(h.target.value)||0}),className:"text-center"})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(G,{className:"text-xs text-muted-foreground mb-1",children:"ðŸŸ¨ Ð–Ðš"}),e.jsx($,{type:"number",min:"0",value:T.yellow_cards,onChange:h=>L({...T,yellow_cards:parseInt(h.target.value)||0}),className:"text-center"})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(G,{className:"text-xs text-muted-foreground mb-1",children:"ðŸŸ¥ ÐšÐš"}),e.jsx($,{type:"number",min:"0",value:T.red_cards,onChange:h=>L({...T,red_cards:parseInt(h.target.value)||0}),className:"text-center"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(w,{onClick:X,className:"flex-1",children:"Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ"}),e.jsx(w,{variant:"outline",onClick:()=>{b(!1),U("")},children:"ÐžÑ‚Ð¼ÐµÐ½Ð°"})]})]}):e.jsxs(w,{onClick:()=>b(!0),variant:"outline",className:"w-full",children:[e.jsx(Me,{className:"w-4 h-4 mr-2"}),"Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÑƒ Ð¸Ð³Ñ€Ð¾ÐºÐ°"]})}),e.jsx("div",{className:"mt-4 p-3 bg-muted/50 rounded-lg text-xs text-muted-foreground",children:e.jsx("p",{children:"âš½ = Ð³Ð¾Ð», ðŸ”„ = Ð°Ð²Ñ‚Ð¾Ð³Ð¾Ð» (Ð·Ð°ÑÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÐµÑ‚ÑÑ ÑÐ¾Ð¿ÐµÑ€Ð½Ð¸ÐºÑƒ), ðŸ‘Ÿ = Ð³Ð¾Ð»ÐµÐ²Ð¾Ð¹ Ð¿Ð°Ñ, ðŸŸ¨ = Ð¶Ñ‘Ð»Ñ‚Ð°Ñ ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ°, ðŸŸ¥ = ÐºÑ€Ð°ÑÐ½Ð°Ñ ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ°"})})]})})}function vo({tourId:t,tourNumber:a}){const{data:s=[]}=mt(t),[r,n]=l.useState(null),[o,c]=l.useState(!1);if(!t||s.length===0)return null;const i=o?s:s.slice(0,3),m=s.length>3;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"stat-card",children:[e.jsxs("h2",{className:"text-xl font-display font-bold text-foreground tracking-wide mb-4",children:["ÐœÐ°Ñ‚Ñ‡Ð¸",a?` Ñ‚ÑƒÑ€Ð° ${a}`:""]}),e.jsx("div",{className:"space-y-2",children:i.map((p,u)=>e.jsxs("div",{onClick:()=>n(p),className:"flex items-center gap-2 sm:gap-4 py-3 px-3 sm:px-4 bg-secondary/50 rounded-lg text-sm hover:bg-secondary/70 transition-colors cursor-pointer group",children:[e.jsxs("span",{className:"text-muted-foreground font-mono text-xs shrink-0",children:["#",u+1]}),e.jsx("span",{className:"flex-1 text-right font-medium text-xs sm:text-sm truncate",children:p.home_team.name}),e.jsxs("span",{className:"shrink-0 font-display font-bold text-base sm:text-lg match-score whitespace-nowrap",children:[p.home_score,":",p.away_score]}),e.jsx("span",{className:"flex-1 text-left font-medium text-xs sm:text-sm truncate",children:p.away_team.name}),e.jsx("span",{className:"text-xs text-muted-foreground opacity-0 group-hover:opacity-100 transition-opacity hidden sm:inline",children:"â†’"})]},p.id))}),m&&e.jsx(w,{variant:"ghost",className:"w-full mt-3 text-muted-foreground hover:text-foreground",onClick:()=>c(!o),children:o?e.jsxs(e.Fragment,{children:[e.jsx(dt,{className:"w-4 h-4 mr-2"}),"Ð¡Ð²ÐµÑ€Ð½ÑƒÑ‚ÑŒ"]}):e.jsxs(e.Fragment,{children:[e.jsx(ut,{className:"w-4 h-4 mr-2"}),"ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ð²ÑÐµ (",s.length," Ð¼Ð°Ñ‚Ñ‡ÐµÐ¹)"]})})]}),e.jsx(No,{match:r,isOpen:!!r,onClose:()=>n(null)})]})}const Lt=5;function bo({tourId:t}){const{data:a=[]}=hr(t),{data:s=[]}=Fe(),{data:r=[]}=Pe(),[n,o]=l.useState(!1),c=l.useMemo(()=>{const u=new Map;return a.forEach(x=>{var y;const f=u.get(x.player_id);if(f)f.goals+=x.goals,f.assists+=x.assists,f.yellowCards+=x.yellow_cards,f.redCards+=x.red_cards;else{const g=s.find(b=>b.id===x.player_id),_=r.find(b=>b.id===(g==null?void 0:g.team_id));u.set(x.player_id,{playerId:x.player_id,playerName:(g==null?void 0:g.name)??((y=x.player)==null?void 0:y.name)??"Unknown",teamName:(_==null?void 0:_.name)??"",teamColor:(_==null?void 0:_.color)??"black",goals:x.goals,assists:x.assists,yellowCards:x.yellow_cards,redCards:x.red_cards})}}),Array.from(u.values()).sort((x,f)=>f.goals-x.goals||f.assists-x.assists)},[a,s,r]),i=n?c:c.slice(0,Lt),m=c.length>Lt,p=u=>{switch(u){case"red":return"text-team-red";case"blue":return"text-team-blue";case"green":return"text-team-green";case"black":return"text-foreground";default:return"text-muted-foreground"}};return!t||c.length===0?e.jsxs("div",{className:"stat-card",children:[e.jsx("h2",{className:"text-xl font-bold text-foreground font-mono mb-4",children:"Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ° Ð¸Ð³Ñ€Ð¾ÐºÐ¾Ð²"}),e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"ÐÐµÑ‚ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð´Ð»Ñ Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ"})]}):e.jsxs("div",{className:"stat-card",children:[e.jsx("h2",{className:"text-xl font-bold text-foreground font-mono mb-4",children:"Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ° Ð¸Ð³Ñ€Ð¾ÐºÐ¾Ð²"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-border text-muted-foreground",children:[e.jsx("th",{className:"text-left py-2 px-2",children:"#"}),e.jsx("th",{className:"text-left py-2 px-2",children:"Ð˜Ð³Ñ€Ð¾Ðº"}),e.jsx("th",{className:"text-left py-2 px-2",children:"ÐšÐ¾Ð¼Ð°Ð½Ð´Ð°"}),e.jsx("th",{className:"text-center py-2 px-1",children:"âš½"}),e.jsx("th",{className:"text-center py-2 px-1",children:"ðŸ…°ï¸"}),e.jsx("th",{className:"text-center py-2 px-1",children:"ðŸŸ¨"}),e.jsx("th",{className:"text-center py-2 px-1",children:"ðŸŸ¥"})]})}),e.jsx("tbody",{children:i.map((u,x)=>e.jsxs("tr",{className:"border-b border-border/50 hover:bg-secondary/50 transition-colors",children:[e.jsx("td",{className:"py-2 px-2 text-muted-foreground",children:x+1}),e.jsx("td",{className:"py-2 px-2 font-medium",children:u.playerName}),e.jsx("td",{className:`py-2 px-2 ${p(u.teamColor)}`,children:u.teamName}),e.jsx("td",{className:"text-center py-2 px-1 font-mono font-bold text-primary",children:u.goals}),e.jsx("td",{className:"text-center py-2 px-1 font-mono",children:u.assists}),e.jsx("td",{className:"text-center py-2 px-1 font-mono",children:u.yellowCards}),e.jsx("td",{className:"text-center py-2 px-1 font-mono",children:u.redCards})]},u.playerId))})]})}),m&&e.jsx("button",{onClick:()=>o(!n),className:"w-full mt-3 py-2 text-sm text-muted-foreground hover:text-foreground transition-colors flex items-center justify-center gap-1 border-t border-border/50",children:n?e.jsxs(e.Fragment,{children:["Ð¡Ð²ÐµÑ€Ð½ÑƒÑ‚ÑŒ ",e.jsx(dt,{className:"w-4 h-4"})]}):e.jsxs(e.Fragment,{children:["ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ð²ÑÐµ (",c.length,") ",e.jsx(ut,{className:"w-4 h-4"})]})})]})}function wo(t,a){let s=0,r=0,n=0,o=0,c=0;return a.forEach(i=>{i.home_team_id===t.id?(o+=i.home_score,c+=i.away_score,i.home_score>i.away_score?s++:i.home_score===i.away_score?r++:n++):i.away_team_id===t.id&&(o+=i.away_score,c+=i.home_score,i.away_score>i.home_score?s++:i.away_score===i.home_score?r++:n++)}),{teamId:t.id,teamName:t.name,teamColor:t.color??"black",played:s+r+n,won:s,drawn:r,lost:n,goalsFor:o,goalsAgainst:c,goalDiff:o-c,points:s*3+r}}const _o=t=>{switch(t){case"red":return"text-team-red";case"blue":return"text-team-blue";case"green":return"text-team-green";case"black":return"text-foreground";default:return"text-muted-foreground"}};function Co(){const{data:t=[]}=Pe(),{data:a=[]}=xt(),s=l.useMemo(()=>t.map(r=>wo(r,a)).filter(r=>r.played>0).sort((r,n)=>n.points-r.points||n.goalDiff-r.goalDiff),[t,a]);return s.length===0?e.jsxs("div",{className:"stat-card",children:[e.jsx("h2",{className:"text-xl font-bold text-foreground font-mono mb-4",children:"ÐžÐ±Ñ‰Ð°Ñ ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ° ÐºÐ¾Ð¼Ð°Ð½Ð´"}),e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"ÐÐµÑ‚ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð´Ð»Ñ Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ"})]}):e.jsxs("div",{className:"stat-card",children:[e.jsx("h2",{className:"text-xl font-bold text-foreground font-mono mb-4",children:"ÐžÐ±Ñ‰Ð°Ñ ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ° ÐºÐ¾Ð¼Ð°Ð½Ð´"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-border text-muted-foreground",children:[e.jsx("th",{className:"text-left py-2 px-2",children:"#"}),e.jsx("th",{className:"text-left py-2 px-2",children:"ÐšÐ¾Ð¼Ð°Ð½Ð´Ð°"}),e.jsx("th",{className:"text-center py-2 px-1",children:"Ð˜"}),e.jsx("th",{className:"text-center py-2 px-1",children:"Ð’"}),e.jsx("th",{className:"text-center py-2 px-1",children:"Ð"}),e.jsx("th",{className:"text-center py-2 px-1",children:"ÐŸ"}),e.jsx("th",{className:"text-center py-2 px-1",children:"Ð“Ð—"}),e.jsx("th",{className:"text-center py-2 px-1",children:"Ð“ÐŸ"}),e.jsx("th",{className:"text-center py-2 px-1",children:"Ð Ð°Ð·Ð½"}),e.jsx("th",{className:"text-center py-2 px-1 text-primary",children:"ÐžÑ‡ÐºÐ¸"})]})}),e.jsx("tbody",{children:s.map((r,n)=>e.jsxs("tr",{className:"border-b border-border/50 hover:bg-secondary/50 transition-colors",children:[e.jsx("td",{className:"py-2 px-2 text-muted-foreground",children:n+1}),e.jsx("td",{className:`py-2 px-2 font-medium ${_o(r.teamColor)}`,children:r.teamName}),e.jsx("td",{className:"text-center py-2 px-1 font-mono",children:r.played}),e.jsx("td",{className:"text-center py-2 px-1 font-mono",children:r.won}),e.jsx("td",{className:"text-center py-2 px-1 font-mono",children:r.drawn}),e.jsx("td",{className:"text-center py-2 px-1 font-mono",children:r.lost}),e.jsx("td",{className:"text-center py-2 px-1 font-mono",children:r.goalsFor}),e.jsx("td",{className:"text-center py-2 px-1 font-mono",children:r.goalsAgainst}),e.jsxs("td",{className:"text-center py-2 px-1 font-mono",children:[r.goalDiff>0?"+":"",r.goalDiff]}),e.jsx("td",{className:"text-center py-2 px-1 font-mono font-bold text-primary",children:r.points})]},r.teamId))})]})})]})}function Mo(t){return it({queryKey:["mvp-counts",t],queryFn:async()=>{if(!t)return new Map;const{data:a,error:s}=await k.from("tours").select("mvp_player_id").eq("season_id",t).not("mvp_player_id","is",null);if(s)throw s;const r=new Map;return a==null||a.forEach(n=>{n.mvp_player_id&&r.set(n.mvp_player_id,(r.get(n.mvp_player_id)||0)+1)}),r},enabled:!!t})}const zt=6;function So(){const{data:t}=gr(),a=(t==null?void 0:t.stats)||[],s=(t==null?void 0:t.substitutions)||[],{data:r=[]}=Fe(),{data:n=[]}=Pe(),{data:o=[]}=xt(),{data:c}=Se(),{data:i=[]}=wr((c==null?void 0:c.id)??null),{data:m=new Map}=Mo((c==null?void 0:c.id)??null),p=l.useMemo(()=>{const N=new Map;return i.forEach(C=>{C.team_type==="dream"&&N.set(C.player_id,(N.get(C.player_id)||0)+1)}),N},[i]),[u,x]=l.useState("goals"),[f,y]=l.useState(!1),g=l.useMemo(()=>{const N=new Set;return s.forEach(C=>{N.add(`${C.original_player_id}_${C.tour_id}`)}),N},[s]),_=l.useMemo(()=>{const N=new Map;return r.forEach(C=>{if(!C.team_id)return;let v=0;o.forEach(I=>{(I.home_team_id===C.team_id||I.away_team_id===C.team_id)&&(g.has(`${C.id}_${I.tour_id}`)||v++)}),N.set(C.id,v)}),s.forEach(C=>{const v=C.substitute_player_id,I=C.tour_id,D=r.find(K=>K.id===C.original_player_id);if(D!=null&&D.team_id){const K=o.filter(O=>O.tour_id===I&&(O.home_team_id===D.team_id||O.away_team_id===D.team_id)),Q=N.get(v)||0;N.set(v,Q+K.length)}}),N},[r,o,g,s]),b=l.useMemo(()=>{const N=new Map;a.forEach(v=>{var K,Q;const I=(K=v.match)==null?void 0:K.tour_id;if(I&&g.has(`${v.player_id}_${I}`))return;const D=N.get(v.player_id);if(D)D.goals+=v.goals||0,D.assists+=v.assists||0,D.yellowCards+=v.yellow_cards||0,D.redCards+=v.red_cards||0,D.ownGoals+=v.own_goals||0;else{const O=r.find(X=>X.id===v.player_id),A=O!=null&&O.team_id?n.find(X=>X.id===O.team_id):null;N.set(v.player_id,{playerId:v.player_id,playerName:(O==null?void 0:O.name)??((Q=v.player)==null?void 0:Q.name)??"Unknown",teamName:(A==null?void 0:A.name)??"Ð›ÐµÐ³Ð¸Ð¾Ð½ÐµÑ€",teamColor:(A==null?void 0:A.color)??"muted",games:_.get(v.player_id)||0,goals:v.goals||0,assists:v.assists||0,yellowCards:v.yellow_cards||0,redCards:v.red_cards||0,ownGoals:v.own_goals||0,dreamTeamCount:p.get(v.player_id)||0,mvpCount:m.get(v.player_id)||0})}}),N.forEach((v,I)=>{v.games=_.get(I)||0,v.dreamTeamCount=p.get(I)||0,v.mvpCount=m.get(I)||0});const C=Array.from(N.values());return C.sort((v,I)=>{const D=I[u]-v[u];return D!==0?D:I.goals-v.goals||I.assists-v.assists}),C},[a,r,n,p,m,u,g,_]),P=f?b:b.slice(0,zt),U=b.length>zt,T=N=>{switch(N){case"red":return"text-team-red";case"blue":return"text-team-blue";case"green":return"text-team-green";case"black":return"text-foreground";case"muted":return"text-muted-foreground italic";default:return"text-muted-foreground"}},L=({column:N,label:C})=>e.jsx("th",{className:`text-center py-2 px-1 cursor-pointer hover:text-primary transition-colors ${u===N?"text-primary":""}`,onClick:()=>x(N),children:e.jsxs("span",{className:"inline-flex items-center gap-0.5",children:[C,u===N&&e.jsx(Cr,{className:"w-3 h-3"})]})});return b.length===0?e.jsxs("div",{className:"stat-card",children:[e.jsx("h2",{className:"text-xl font-bold text-foreground font-mono mb-4",children:"ÐžÐ±Ñ‰Ð°Ñ ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ° Ð¸Ð³Ñ€Ð¾ÐºÐ¾Ð²"}),e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"ÐÐµÑ‚ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð´Ð»Ñ Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ"})]}):e.jsxs("div",{className:"stat-card",children:[e.jsx("h2",{className:"text-xl font-bold text-foreground font-mono mb-4",children:"ÐžÐ±Ñ‰Ð°Ñ ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ° Ð¸Ð³Ñ€Ð¾ÐºÐ¾Ð²"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-border text-muted-foreground text-xs",children:[e.jsx("th",{className:"text-left py-2 px-2",children:"#"}),e.jsx("th",{className:"text-left py-2 px-2",children:"Ð˜Ð³Ñ€Ð¾Ðº"}),e.jsx("th",{className:"text-left py-2 px-2 hidden sm:table-cell",children:"ÐšÐ¾Ð¼Ð°Ð½Ð´Ð°"}),e.jsx(L,{column:"games",label:"ðŸŽ®"}),e.jsx(L,{column:"goals",label:"âš½"}),e.jsx(L,{column:"assists",label:"ðŸ…°ï¸"}),e.jsx(L,{column:"ownGoals",label:"ðŸ”„"}),e.jsx(L,{column:"yellowCards",label:"ðŸŸ¨"}),e.jsx(L,{column:"redCards",label:"ðŸŸ¥"}),e.jsx("th",{className:"text-center py-2 px-1",children:"â­"}),e.jsx("th",{className:"text-center py-2 px-1",children:"ðŸ†"})]})}),e.jsx("tbody",{children:P.map((N,C)=>e.jsxs("tr",{className:"border-b border-border/50 hover:bg-secondary/50 transition-colors",children:[e.jsx("td",{className:"py-2 px-2 text-muted-foreground text-xs",children:C+1}),e.jsxs("td",{className:"py-2 px-2 font-medium text-sm",children:[e.jsx("span",{className:"block",children:N.playerName}),e.jsx("span",{className:`sm:hidden text-xs ${T(N.teamColor)}`,children:N.teamName})]}),e.jsx("td",{className:`py-2 px-2 hidden sm:table-cell ${T(N.teamColor)}`,children:N.teamName}),e.jsx("td",{className:"text-center py-2 px-1 font-mono text-sm text-muted-foreground",children:N.games}),e.jsx("td",{className:"text-center py-2 px-1 font-mono font-bold text-primary text-sm",children:N.goals}),e.jsx("td",{className:"text-center py-2 px-1 font-mono text-sm",children:N.assists}),e.jsx("td",{className:"text-center py-2 px-1 font-mono text-sm text-orange-500",children:N.ownGoals>0?N.ownGoals:"-"}),e.jsx("td",{className:"text-center py-2 px-1 font-mono text-sm",children:N.yellowCards}),e.jsx("td",{className:"text-center py-2 px-1 font-mono text-sm",children:N.redCards}),e.jsx("td",{className:"text-center py-2 px-1 font-mono text-yellow-500 text-sm",children:N.dreamTeamCount>0?N.dreamTeamCount:"-"}),e.jsx("td",{className:"text-center py-2 px-1 font-mono text-amber-500 text-sm",children:N.mvpCount>0?N.mvpCount:"-"})]},N.playerId))})]})}),U&&e.jsx("button",{onClick:()=>y(!f),className:"w-full mt-3 py-2 text-sm text-muted-foreground hover:text-foreground transition-colors flex items-center justify-center gap-1 border-t border-border/50",children:f?e.jsxs(e.Fragment,{children:["Ð¡Ð²ÐµÑ€Ð½ÑƒÑ‚ÑŒ ",e.jsx(dt,{className:"w-4 h-4"})]}):e.jsxs(e.Fragment,{children:["ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ð²ÑÐµ (",b.length,") ",e.jsx(ut,{className:"w-4 h-4"})]})})]})}function Po({tourId:t}){const{data:a=[]}=Ot(t,"dream"),{data:s=[]}=Ot(t,"anti"),r=ur(),n=l.useMemo(()=>{const c=new Array(5).fill("");return a.forEach(i=>{i.position>=1&&i.position<=5&&(c[i.position-1]=i.player_id)}),c},[a]),o=l.useMemo(()=>{const c=new Array(5).fill("");return s.forEach(i=>{i.position>=1&&i.position<=5&&(c[i.position-1]=i.player_id)}),c},[s]);return t?e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsx(Ft,{title:"Ð¡Ð±Ð¾Ñ€Ð½Ð°Ñ Ñ‚ÑƒÑ€Ð°",type:"dream",selectedPlayerIds:n,onSave:c=>r.mutate({tourId:t,teamType:"dream",playerIds:c.filter(Boolean)}),isPending:r.isPending}),e.jsx(Ft,{title:"ÐÐ½Ñ‚Ð¸ÑÐ±Ð¾Ñ€Ð½Ð°Ñ Ñ‚ÑƒÑ€Ð°",type:"anti",selectedPlayerIds:o,onSave:c=>r.mutate({tourId:t,teamType:"anti",playerIds:c.filter(Boolean)}),isPending:r.isPending})]}):null}function To(){const t=oe();return le({mutationFn:async({tourId:a,videoUrl:s})=>{const{error:r}=await k.from("tours").update({video_url:s}).eq("id",a);if(r)throw r},onSuccess:()=>{t.invalidateQueries({queryKey:["tours"]}),t.invalidateQueries({queryKey:["current-tour"]}),M.success("Ð’Ð¸Ð´ÐµÐ¾ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¾")},onError:a=>{M.error(a.message)}})}function Do(t){if(!t)return null;const a=[/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([a-zA-Z0-9_-]{11})/,/^([a-zA-Z0-9_-]{11})$/];for(const s of a){const r=t.match(s);if(r)return r[1]}return null}function Eo({videoUrl:t,tourNumber:a}){const s=Do(t);return s?e.jsxs("div",{className:"stat-card",children:[e.jsxs("h2",{className:"text-xl font-bold text-foreground font-mono mb-4",children:["Ð’Ð¸Ð´ÐµÐ¾ Ñ‚ÑƒÑ€Ð° ",a]}),e.jsx("div",{className:"aspect-video rounded-lg overflow-hidden",children:e.jsx("iframe",{className:"w-full h-full",src:`https://www.youtube.com/embed/${s}`,title:`Ð’Ð¸Ð´ÐµÐ¾ Ñ‚ÑƒÑ€Ð° ${a}`,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})})]}):null}function Ro(){const t=oe();return le({mutationFn:async({playerId:a,file:s})=>{const r=s.name.split(".").pop(),o=`${a}-${Date.now()}.${r}`,{error:c}=await k.storage.from("player-photos").upload(o,s,{upsert:!0});if(c)throw c;const{data:{publicUrl:i}}=k.storage.from("player-photos").getPublicUrl(o),{error:m}=await k.from("players").update({photo_url:i}).eq("id",a);if(m)throw m;return i},onSuccess:()=>{t.invalidateQueries({queryKey:["players"]}),M.success("Ð¤Ð¾Ñ‚Ð¾ Ð·Ð°Ð³Ñ€ÑƒÐ¶ÐµÐ½Ð¾")},onError:a=>{M.error(a.message)}})}function Io(){const t=oe();return le({mutationFn:async({playerId:a,photoUrl:s})=>{const r=s.split("/"),n=r[r.length-1],{error:o}=await k.storage.from("player-photos").remove([n]);o&&console.warn("Could not delete file from storage:",o);const{error:c}=await k.from("players").update({photo_url:null}).eq("id",a);if(c)throw c},onSuccess:()=>{t.invalidateQueries({queryKey:["players"]}),M.success("Ð¤Ð¾Ñ‚Ð¾ ÑƒÐ´Ð°Ð»ÐµÐ½Ð¾")},onError:a=>{M.error(a.message)}})}function ko(){const t=oe();return le({mutationFn:async({playerId:a,file:s,oldPhotoUrl:r})=>{if(r){const u=r.split("/"),x=u[u.length-1];await k.storage.from("player-photos").remove([x]).catch(()=>{})}const n=s.name.split(".").pop(),c=`${a}-${Date.now()}.${n}`,{error:i}=await k.storage.from("player-photos").upload(c,s,{upsert:!0});if(i)throw i;const{data:{publicUrl:m}}=k.storage.from("player-photos").getPublicUrl(c),{error:p}=await k.from("players").update({photo_url:m}).eq("id",a);if(p)throw p;return m},onSuccess:()=>{t.invalidateQueries({queryKey:["players"]}),M.success("Ð¤Ð¾Ñ‚Ð¾ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¾")},onError:a=>{M.error(a.message)}})}function Ao(t){return it({queryKey:["tour-substitutions",t],queryFn:async()=>{if(!t)return[];const{data:a,error:s}=await k.from("tour_player_substitutions").select(`
          *,
          original_player:players!tour_player_substitutions_original_player_id_fkey(id, name),
          substitute_player:players!tour_player_substitutions_substitute_player_id_fkey(id, name)
        `).eq("tour_id",t);if(s)throw s;return a},enabled:!!t})}function Oo(){const t=oe();return le({mutationFn:async a=>{const{data:s,error:r}=await k.from("tour_player_substitutions").insert(a).select().single();if(r)throw r;return s},onSuccess:(a,s)=>{t.invalidateQueries({queryKey:["tour-substitutions",s.tour_id]}),t.invalidateQueries({queryKey:["all-tour-substitutions"]}),M.success("Ð—Ð°Ð¼ÐµÐ½Ð° Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð°")},onError:a=>{M.error(a.message)}})}function Fo(){const t=oe();return le({mutationFn:async({id:a,tourId:s})=>{const{error:r}=await k.from("tour_player_substitutions").delete().eq("id",a);if(r)throw r;return s},onSuccess:a=>{t.invalidateQueries({queryKey:["tour-substitutions",a]}),t.invalidateQueries({queryKey:["all-tour-substitutions"]}),M.success("Ð—Ð°Ð¼ÐµÐ½Ð° ÑƒÐ´Ð°Ð»ÐµÐ½Ð°")},onError:a=>{M.error(a.message)}})}const $o=Be().trim().min(2,"ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹ Ð´Ð¾Ð»Ð¶Ð½Ð¾ ÑÐ¾Ð´ÐµÑ€Ð¶Ð°Ñ‚ÑŒ Ð¼Ð¸Ð½Ð¸Ð¼ÑƒÐ¼ 2 ÑÐ¸Ð¼Ð²Ð¾Ð»Ð°").max(50,"ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹ Ð½Ðµ Ð´Ð¾Ð»Ð¶Ð½Ð¾ Ð¿Ñ€ÐµÐ²Ñ‹ÑˆÐ°Ñ‚ÑŒ 50 ÑÐ¸Ð¼Ð²Ð¾Ð»Ð¾Ð²").regex(/^[a-zA-ZÐ°-ÑÐ-Ð¯Ñ‘Ð0-9\s\-]+$/,"Ð¢Ð¾Ð»ÑŒÐºÐ¾ Ð±ÑƒÐºÐ²Ñ‹, Ñ†Ð¸Ñ„Ñ€Ñ‹, Ð¿Ñ€Ð¾Ð±ÐµÐ»Ñ‹ Ð¸ Ð´ÐµÑ„Ð¸ÑÑ‹"),Lo=Be().trim().min(2,"Ð˜Ð¼Ñ Ð¸Ð³Ñ€Ð¾ÐºÐ° Ð´Ð¾Ð»Ð¶Ð½Ð¾ ÑÐ¾Ð´ÐµÑ€Ð¶Ð°Ñ‚ÑŒ Ð¼Ð¸Ð½Ð¸Ð¼ÑƒÐ¼ 2 ÑÐ¸Ð¼Ð²Ð¾Ð»Ð°").max(50,"Ð˜Ð¼Ñ Ð¸Ð³Ñ€Ð¾ÐºÐ° Ð½Ðµ Ð´Ð¾Ð»Ð¶Ð½Ð¾ Ð¿Ñ€ÐµÐ²Ñ‹ÑˆÐ°Ñ‚ÑŒ 50 ÑÐ¸Ð¼Ð²Ð¾Ð»Ð¾Ð²").regex(/^[a-zA-ZÐ°-ÑÐ-Ð¯Ñ‘Ð\s\-\.]+$/,"Ð¢Ð¾Ð»ÑŒÐºÐ¾ Ð±ÑƒÐºÐ²Ñ‹, Ð¿Ñ€Ð¾Ð±ÐµÐ»Ñ‹, Ð´ÐµÑ„Ð¸ÑÑ‹ Ð¸ Ñ‚Ð¾Ñ‡ÐºÐ¸"),zo=ir({goals:Re().min(0).max(2,"ÐœÐ°ÐºÑÐ¸Ð¼ÑƒÐ¼ 2 Ð³Ð¾Ð»Ð°"),own_goals:Re().min(0).max(2,"ÐœÐ°ÐºÑÐ¸Ð¼ÑƒÐ¼ 2 Ð°Ð²Ñ‚Ð¾Ð³Ð¾Ð»Ð°"),assists:Re().min(0).max(5,"ÐœÐ°ÐºÑÐ¸Ð¼ÑƒÐ¼ 5 Ð°ÑÑÐ¸ÑÑ‚Ð¾Ð²"),yellow_cards:Re().min(0).max(2,"ÐœÐ°ÐºÑÐ¸Ð¼ÑƒÐ¼ 2 Ð¶Ñ‘Ð»Ñ‚Ñ‹Ðµ ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ¸"),red_cards:Re().min(0).max(1,"ÐœÐ°ÐºÑÐ¸Ð¼ÑƒÐ¼ 1 ÐºÑ€Ð°ÑÐ½Ð°Ñ ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ°")}),Go=Be().trim().refine(t=>t===""||/^(https?:\/\/)?(www\.)?(youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)[\w-]+/.test(t),"ÐÐµÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð°Ñ ÑÑÑ‹Ð»ÐºÐ° Ð½Ð° YouTube").optional().or(dr(""));function Uo({tourId:t}){var At;const{isAdmin:a}=fe(),{data:s}=Se(),{data:r=[]}=Qe((s==null?void 0:s.id)??null),{data:n=[]}=Pe(),{data:o=[]}=ts(t),{data:c=[]}=Fe(),{data:i=[]}=mt(t),{data:m=[]}=Ao(t),p=Ja(),u=er(),x=Nr(),f=vr(),y=tr();sr();const g=ar(),_=yr();jr();const b=Jt(),P=va(),U=To(),T=Ro(),L=Io(),N=ko(),C=Oo(),v=Fo(),I=l.useRef(null),[D,K]=l.useState(""),[Q,O]=l.useState(""),[A,X]=l.useState(""),[ge,ye]=l.useState(""),[h,F]=l.useState(""),[j,E]=l.useState(""),[Z,te]=l.useState(""),[ce,_e]=l.useState(""),[je,ie]=l.useState(""),[se,Te]=l.useState(""),[Y,De]=l.useState(""),[Ee,ba]=l.useState(""),[et,wa]=l.useState(""),[_t,Ct]=l.useState("0"),[Mt,St]=l.useState("0"),[Pt,Tt]=l.useState("0"),[Dt,Et]=l.useState("0"),[Rt,It]=l.useState("0"),[tt,_a]=l.useState(""),ze=r.find(d=>d.id===t),Ca=d=>{var de;const R=(de=d.target.files)==null?void 0:de[0];if(R&&A){const Ge=c.find(za=>za.id===A);Ge!=null&&Ge.photo_url?N.mutate({playerId:A,file:R,oldPhotoUrl:Ge.photo_url}):T.mutate({playerId:A,file:R}),X(""),I.current&&(I.current.value="")}},Ma=()=>{const d=c.find(R=>R.id===A);d!=null&&d.photo_url&&(L.mutate({playerId:A,photoUrl:d.photo_url}),X(""))},st=(At=c.find(d=>d.id===A))==null?void 0:At.photo_url;if(!a)return null;const Sa=()=>{const d=$o.safeParse(j);if(!d.success){M.error(d.error.errors[0].message);return}p.mutate(d.data),E("")},Pa=()=>{if(!ce){M.error('Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ Ð¸Ð»Ð¸ "Ð›ÐµÐ³Ð¸Ð¾Ð½ÐµÑ€"');return}const d=Lo.safeParse(Z);if(!d.success){M.error(d.error.errors[0].message);return}const R=ce==="legioner"?null:ce;y.mutate({name:d.data,teamId:R}),te(""),_e("")},Ta=()=>{!je||!t||(x.mutate({tourId:t,teamId:je}),ie(""))},Da=()=>{if(!se||!Y||!t){M.error("Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð¾Ð±Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹");return}if(se===Y){M.error("ÐšÐ¾Ð¼Ð°Ð½Ð´Ñ‹ Ð´Ð¾Ð»Ð¶Ð½Ñ‹ Ð±Ñ‹Ñ‚ÑŒ Ñ€Ð°Ð·Ð½Ñ‹Ð¼Ð¸");return}_.mutate({tour_id:t,home_team_id:se,away_team_id:Y,home_score:0,away_score:0}),Te(""),De("")},Ea=async()=>{if(!Ee||!et){M.error("Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð¼Ð°Ñ‚Ñ‡ Ð¸ Ð¸Ð³Ñ€Ð¾ÐºÐ°");return}const d={goals:parseInt(_t)||0,own_goals:parseInt(Mt)||0,assists:parseInt(Pt)||0,yellow_cards:parseInt(Dt)||0,red_cards:parseInt(Rt)||0},R=zo.safeParse(d);if(!R.success){M.error(R.error.errors[0].message);return}await b.mutateAsync({match_id:Ee,player_id:et,goals:R.data.goals,own_goals:R.data.own_goals,assists:R.data.assists,yellow_cards:R.data.yellow_cards,red_cards:R.data.red_cards}),await P.mutateAsync(Ee),Ct("0"),St("0"),Tt("0"),Et("0"),It("0")},Ra=()=>{if(!t)return;const d=Go.safeParse(tt);if(!d.success){M.error(d.error.errors[0].message);return}U.mutate({tourId:t,videoUrl:tt||null})},Ia=()=>{if(!t||!D||!Q){M.error("Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð¸Ð³Ñ€Ð¾ÐºÐ° Ð¸ Ð»ÐµÐ³Ð¸Ð¾Ð½ÐµÑ€Ð°");return}if(D===Q){M.error("Ð˜Ð³Ñ€Ð¾ÐºÐ¸ Ð´Ð¾Ð»Ð¶Ð½Ñ‹ Ð±Ñ‹Ñ‚ÑŒ Ñ€Ð°Ð·Ð½Ñ‹Ð¼Ð¸");return}C.mutate({tour_id:t,original_player_id:D,substitute_player_id:Q}),K(""),O("")},ka=o.map(d=>d.team_id),Aa=n.filter(d=>!ka.includes(d.id)),at=i.find(d=>d.id===Ee),kt=at?[at.home_team_id,at.away_team_id]:[],Oa=kt.length>0?c.filter(d=>kt.includes(d.team_id)||d.team_id===null):c,Fa=c.filter(d=>d.team_id!==null),$a=c.filter(d=>d.team_id===null),La=m.map(d=>d.original_player_id);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-foreground font-mono flex items-center gap-2",children:[e.jsx(Dr,{className:"w-5 h-5 text-primary"}),"ÐŸÐ°Ð½ÐµÐ»ÑŒ Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð°"]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs(ue,{className:"bg-card border-border",children:[e.jsx(me,{className:"pb-2",children:e.jsxs(xe,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(rr,{className:"w-4 h-4 text-primary"}),"ÐšÐ¾Ð¼Ð°Ð½Ð´Ñ‹"]})}),e.jsxs(pe,{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx($,{placeholder:"ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹",value:j,onChange:d=>E(d.target.value),className:"bg-secondary border-border text-foreground"}),e.jsx(w,{size:"sm",onClick:Sa,disabled:p.isPending,children:e.jsx(Me,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"max-h-32 overflow-y-auto space-y-1",children:n.map(d=>e.jsxs("div",{className:"flex items-center justify-between text-sm py-1",children:[e.jsx("span",{children:d.name}),e.jsx(w,{variant:"ghost",size:"icon",className:"h-6 w-6 text-destructive",onClick:()=>u.mutate(d.id),children:e.jsx(Ce,{className:"w-3 h-3"})})]},d.id))})]})]}),e.jsxs(ue,{className:"bg-card border-border",children:[e.jsx(me,{className:"pb-2",children:e.jsx(xe,{className:"text-sm font-medium",children:"Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ Ð² Ñ‚ÑƒÑ€"})}),e.jsxs(pe,{className:"space-y-3",children:[e.jsxs(V,{value:je,onValueChange:ie,children:[e.jsx(q,{className:"bg-secondary border-border",children:e.jsx(B,{placeholder:"Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ"})}),e.jsx(H,{children:Aa.map(d=>e.jsx(z,{value:d.id,children:d.name},d.id))})]}),e.jsx(w,{size:"sm",className:"w-full",onClick:Ta,disabled:!je||!t,children:"Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð² Ñ‚ÑƒÑ€"}),e.jsx("div",{className:"max-h-32 overflow-y-auto space-y-1",children:o.map(d=>e.jsxs("div",{className:"flex items-center justify-between text-sm py-1",children:[e.jsx("span",{children:d.team.name}),e.jsx(w,{variant:"ghost",size:"icon",className:"h-6 w-6 text-destructive",onClick:()=>f.mutate(d.id),children:e.jsx(Ce,{className:"w-3 h-3"})})]},d.id))})]})]}),e.jsxs(ue,{className:"bg-card border-border",children:[e.jsx(me,{className:"pb-2",children:e.jsxs(xe,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(ss,{className:"w-4 h-4 text-primary"}),"Ð˜Ð³Ñ€Ð¾ÐºÐ¸"]})}),e.jsxs(pe,{className:"space-y-3",children:[e.jsxs(V,{value:ce,onValueChange:_e,children:[e.jsx(q,{className:"bg-secondary border-border",children:e.jsx(B,{placeholder:"ÐšÐ¾Ð¼Ð°Ð½Ð´Ð° Ð¸Ð³Ñ€Ð¾ÐºÐ°"})}),e.jsxs(H,{children:[e.jsx(z,{value:"legioner",children:"âš¡ Ð›ÐµÐ³Ð¸Ð¾Ð½ÐµÑ€ (Ð±ÐµÐ· ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹)"}),n.map(d=>e.jsx(z,{value:d.id,children:d.name},d.id))]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx($,{placeholder:"Ð˜Ð¼Ñ Ð¸Ð³Ñ€Ð¾ÐºÐ°",value:Z,onChange:d=>te(d.target.value),className:"bg-secondary border-border text-foreground"}),e.jsx(w,{size:"sm",onClick:Pa,disabled:y.isPending,children:e.jsx(Me,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"border-t border-border pt-3 mt-3",children:[e.jsx(G,{className:"text-xs text-muted-foreground mb-2 block",children:"Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ñ„Ð¾Ñ‚Ð¾ Ð¸Ð³Ñ€Ð¾ÐºÐ°"}),e.jsx("p",{className:"text-[10px] text-muted-foreground/70 mb-2",children:"ðŸ“· Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÐµÐ¼Ñ‹Ð¹ Ñ€Ð°Ð·Ð¼ÐµÑ€: 300Ã—300px, Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚ JPG/PNG, ÐºÐ²Ð°Ð´Ñ€Ð°Ñ‚Ð½Ð¾Ðµ Ñ„Ð¾Ñ‚Ð¾ Ð´Ð»Ñ Ð¸Ð´ÐµÐ°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ Ð² ÐºÑ€ÑƒÐ³Ðµ"}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsxs(V,{value:A,onValueChange:X,children:[e.jsx(q,{className:"bg-secondary border-border flex-1",children:e.jsx(B,{placeholder:"Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð¸Ð³Ñ€Ð¾ÐºÐ°"})}),e.jsx(H,{children:c.map(d=>e.jsx(z,{value:d.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(rt,{className:"h-5 w-5",children:[e.jsx(nt,{src:d.photo_url,alt:d.name}),e.jsx(ot,{className:"text-[10px]",children:d.name[0]})]}),d.name,d.photo_url&&e.jsx("span",{className:"text-xs text-green-500",children:"âœ“"})]})},d.id))})]}),e.jsx("input",{type:"file",accept:"image/*",ref:I,onChange:Ca,className:"hidden"}),e.jsx(w,{size:"sm",variant:"outline",onClick:()=>{var d;return(d=I.current)==null?void 0:d.click()},disabled:!A||T.isPending||N.isPending,title:st?"Ð—Ð°Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ Ñ„Ð¾Ñ‚Ð¾":"Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ñ„Ð¾Ñ‚Ð¾",children:st?e.jsx(We,{className:"w-4 h-4"}):e.jsx(Mr,{className:"w-4 h-4"})}),st&&e.jsx(w,{size:"sm",variant:"destructive",onClick:Ma,disabled:L.isPending,title:"Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ñ„Ð¾Ñ‚Ð¾",children:e.jsx(Ce,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"border-t border-border pt-3 mt-3",children:[e.jsx(G,{className:"text-xs text-muted-foreground mb-2 block",children:"Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ Ð¸Ð³Ñ€Ð¾ÐºÐ°"}),e.jsx("div",{className:"flex gap-2 items-center",children:e.jsxs(V,{value:ge,onValueChange:d=>{ye(d);const R=c.find(de=>de.id===d);F((R==null?void 0:R.team_id)||"legioner")},children:[e.jsx(q,{className:"bg-secondary border-border flex-1",children:e.jsx(B,{placeholder:"Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð¸Ð³Ñ€Ð¾ÐºÐ°"})}),e.jsx(H,{children:c.map(d=>{const R=n.find(de=>de.id===d.team_id);return e.jsxs(z,{value:d.id,children:[d.name," (",(R==null?void 0:R.name)||"Ð›ÐµÐ³Ð¸Ð¾Ð½ÐµÑ€",")"]},d.id)})})]})}),ge&&e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsxs(V,{value:h,onValueChange:F,children:[e.jsx(q,{className:"bg-secondary border-border flex-1",children:e.jsx(B,{placeholder:"ÐÐ¾Ð²Ð°Ñ ÐºÐ¾Ð¼Ð°Ð½Ð´Ð°"})}),e.jsxs(H,{children:[e.jsx(z,{value:"legioner",children:"âš¡ Ð›ÐµÐ³Ð¸Ð¾Ð½ÐµÑ€ (Ð±ÐµÐ· ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹)"}),n.map(d=>e.jsx(z,{value:d.id,children:d.name},d.id))]})]}),e.jsx(w,{size:"sm",onClick:()=>{const d=h==="legioner"?null:h;g.mutate({id:ge,teamId:d}),ye(""),F("")},disabled:g.isPending,children:"Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ"})]})]})]})]}),e.jsxs(ue,{className:"bg-card border-border",children:[e.jsx(me,{className:"pb-2",children:e.jsx(xe,{className:"text-sm font-medium",children:"Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð¼Ð°Ñ‚Ñ‡"})}),e.jsxs(pe,{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(V,{value:se,onValueChange:Te,children:[e.jsx(q,{className:"bg-secondary border-border",children:e.jsx(B,{placeholder:"Ð¥Ð¾Ð·ÑÐµÐ²Ð°"})}),e.jsx(H,{children:o.map(d=>e.jsx(z,{value:d.team_id,children:d.team.name},d.team_id))})]}),e.jsxs(V,{value:Y,onValueChange:De,children:[e.jsx(q,{className:"bg-secondary border-border",children:e.jsx(B,{placeholder:"Ð“Ð¾ÑÑ‚Ð¸"})}),e.jsx(H,{children:o.map(d=>e.jsx(z,{value:d.team_id,children:d.team.name},d.team_id))})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Ð¡Ñ‡Ñ‘Ñ‚ Ñ€Ð°ÑÑÑ‡Ð¸Ñ‚Ð°ÐµÑ‚ÑÑ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð¸Ð· ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ¸ Ð¸Ð³Ñ€Ð¾ÐºÐ¾Ð²"}),e.jsx(w,{size:"sm",className:"w-full",onClick:Da,children:"Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð¼Ð°Ñ‚Ñ‡"})]})]}),e.jsxs(ue,{className:"bg-card border-border md:col-span-2",children:[e.jsx(me,{className:"pb-2",children:e.jsx(xe,{className:"text-sm font-medium",children:"Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ° Ð¸Ð³Ñ€Ð¾ÐºÐ°"})}),e.jsxs(pe,{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(V,{value:Ee,onValueChange:ba,children:[e.jsx(q,{className:"bg-secondary border-border",children:e.jsx(B,{placeholder:"ÐœÐ°Ñ‚Ñ‡"})}),e.jsx(H,{children:i.map(d=>e.jsxs(z,{value:d.id,children:[d.home_team.name," vs ",d.away_team.name]},d.id))})]}),e.jsxs(V,{value:et,onValueChange:wa,children:[e.jsx(q,{className:"bg-secondary border-border",children:e.jsx(B,{placeholder:"Ð˜Ð³Ñ€Ð¾Ðº"})}),e.jsx(H,{children:Oa.map(d=>e.jsx(z,{value:d.id,children:d.name},d.id))})]})]}),e.jsxs("div",{className:"grid grid-cols-5 gap-2",children:[e.jsxs("div",{children:[e.jsx(G,{className:"text-xs text-muted-foreground",children:"âš½ Ð“Ð¾Ð»Ñ‹ (Ð¼Ð°ÐºÑ. 2)"}),e.jsx($,{type:"number",min:"0",max:"2",value:_t,onChange:d=>Ct(d.target.value),className:"bg-secondary border-border text-foreground text-center"})]}),e.jsxs("div",{children:[e.jsx(G,{className:"text-xs text-muted-foreground",children:"ðŸ”„ ÐÐ²Ñ‚Ð¾Ð³Ð¾Ð»"}),e.jsx($,{type:"number",min:"0",max:"2",value:Mt,onChange:d=>St(d.target.value),className:"bg-secondary border-border text-foreground text-center"})]}),e.jsxs("div",{children:[e.jsx(G,{className:"text-xs text-muted-foreground",children:"ðŸ‘Ÿ ÐŸÐ°ÑÑ‹"}),e.jsx($,{type:"number",min:"0",value:Pt,onChange:d=>Tt(d.target.value),className:"bg-secondary border-border text-foreground text-center"})]}),e.jsxs("div",{children:[e.jsx(G,{className:"text-xs text-muted-foreground",children:"ðŸŸ¨ Ð–Ðš"}),e.jsx($,{type:"number",min:"0",value:Dt,onChange:d=>Et(d.target.value),className:"bg-secondary border-border text-foreground text-center"})]}),e.jsxs("div",{children:[e.jsx(G,{className:"text-xs text-muted-foreground",children:"ðŸŸ¥ ÐšÐš"}),e.jsx($,{type:"number",min:"0",value:Rt,onChange:d=>It(d.target.value),className:"bg-secondary border-border text-foreground text-center"})]})]}),e.jsx(w,{size:"sm",className:"w-full",onClick:Ea,disabled:b.isPending||P.isPending,children:"Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÑƒ"})]})]}),e.jsxs(ue,{className:"bg-card border-border",children:[e.jsx(me,{className:"pb-2",children:e.jsxs(xe,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Er,{className:"w-4 h-4 text-primary"}),"Ð’Ð¸Ð´ÐµÐ¾ Ñ‚ÑƒÑ€Ð°"]})}),e.jsxs(pe,{className:"space-y-3",children:[e.jsx($,{placeholder:"YouTube URL",value:tt,onChange:d=>_a(d.target.value),className:"bg-secondary border-border text-foreground"}),(ze==null?void 0:ze.video_url)&&e.jsxs("p",{className:"text-xs text-muted-foreground truncate",children:["Ð¢ÐµÐºÑƒÑ‰ÐµÐµ: ",ze.video_url]}),e.jsx(w,{size:"sm",className:"w-full",onClick:Ra,disabled:!t||U.isPending,children:"Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ Ð²Ð¸Ð´ÐµÐ¾"})]})]}),e.jsxs(ue,{className:"bg-card border-border md:col-span-2",children:[e.jsx(me,{className:"pb-2",children:e.jsxs(xe,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(_r,{className:"w-4 h-4 text-primary"}),"Ð—Ð°Ð¼ÐµÐ½Ñ‹ Ð¸Ð³Ñ€Ð¾ÐºÐ¾Ð² (Ð»ÐµÐ³Ð¸Ð¾Ð½ÐµÑ€Ñ‹)"]})}),e.jsxs(pe,{className:"space-y-3",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Ð£ÐºÐ°Ð¶Ð¸Ñ‚Ðµ, ÐºÐ°ÐºÐ¾Ð³Ð¾ Ð¸Ð³Ñ€Ð¾ÐºÐ° Ð·Ð°Ð¼ÐµÐ½ÑÐµÑ‚ Ð»ÐµÐ³Ð¸Ð¾Ð½ÐµÑ€ Ð² ÑÑ‚Ð¾Ð¼ Ñ‚ÑƒÑ€Ðµ. ÐŸÑ€Ð¾Ð¿ÑƒÑÐºÐ°ÑŽÑ‰ÐµÐ¼Ñƒ Ð¸Ð³Ñ€Ð¾ÐºÑƒ Ð½Ðµ Ð±ÑƒÐ´ÑƒÑ‚ Ð·Ð°ÑÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°Ñ‚ÑŒÑÑ Ð¸Ð³Ñ€Ñ‹."}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(V,{value:D,onValueChange:K,children:[e.jsx(q,{className:"bg-secondary border-border",children:e.jsx(B,{placeholder:"ÐŸÑ€Ð¾Ð¿ÑƒÑÐºÐ°ÐµÑ‚ Ñ‚ÑƒÑ€"})}),e.jsx(H,{children:Fa.filter(d=>!La.includes(d.id)).map(d=>{const R=n.find(de=>de.id===d.team_id);return e.jsxs(z,{value:d.id,children:[d.name," (",(R==null?void 0:R.name)||"Ð‘ÐµÐ· ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹",")"]},d.id)})})]}),e.jsxs(V,{value:Q,onValueChange:O,children:[e.jsx(q,{className:"bg-secondary border-border",children:e.jsx(B,{placeholder:"Ð›ÐµÐ³Ð¸Ð¾Ð½ÐµÑ€"})}),e.jsx(H,{children:$a.map(d=>e.jsxs(z,{value:d.id,children:["âš¡ ",d.name]},d.id))})]})]}),e.jsx(w,{size:"sm",className:"w-full",onClick:Ia,disabled:!t||!D||!Q||C.isPending,children:"Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð·Ð°Ð¼ÐµÐ½Ñƒ"}),m.length>0&&e.jsxs("div",{className:"border-t border-border pt-3 mt-3 space-y-2",children:[e.jsx(G,{className:"text-xs text-muted-foreground",children:"Ð¢ÐµÐºÑƒÑ‰Ð¸Ðµ Ð·Ð°Ð¼ÐµÐ½Ñ‹:"}),m.map(d=>e.jsxs("div",{className:"flex items-center justify-between text-sm py-1 bg-secondary/50 px-2 rounded",children:[e.jsxs("span",{children:[e.jsx("span",{className:"text-muted-foreground",children:d.original_player.name}),e.jsx("span",{className:"mx-2",children:"â†’"}),e.jsxs("span",{className:"text-primary font-medium",children:["âš¡ ",d.substitute_player.name]})]}),e.jsx(w,{variant:"ghost",size:"icon",className:"h-6 w-6 text-destructive",onClick:()=>v.mutate({id:d.id,tourId:t}),children:e.jsx(Ce,{className:"w-3 h-3"})})]},d.id))]})]})]})]})]})}function Ko(){return it({queryKey:["admins"],queryFn:async()=>{const{data:t,error:a}=await k.from("user_roles").select("*").order("created_at");if(a)throw a;const s=t.map(o=>o.user_id),{data:r}=await k.from("profiles").select("user_id, email").in("user_id",s),n=new Map((r==null?void 0:r.map(o=>[o.user_id,o.email]))||[]);return t.map(o=>({...o,email:n.get(o.user_id)||"Unknown"}))}})}function Vo(){const t=oe();return le({mutationFn:async a=>{const{data:s,error:r}=await k.from("profiles").select("user_id").eq("email",a).maybeSingle();if(r)throw r;if(!s)throw new Error("ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½");const{data:n}=await k.from("user_roles").select("*").eq("user_id",s.user_id).maybeSingle();if(n)throw new Error("ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ ÑƒÐ¶Ðµ ÑÐ²Ð»ÑÐµÑ‚ÑÑ Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð¾Ð¼");const{data:o,error:c}=await k.from("user_roles").insert({user_id:s.user_id,role:"admin"}).select().single();if(c)throw c;return o},onSuccess:()=>{t.invalidateQueries({queryKey:["admins"]}),M.success("ÐÐ´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€ Ð½Ð°Ð·Ð½Ð°Ñ‡ÐµÐ½")},onError:a=>{M.error(a.message)}})}function qo(){const t=oe();return le({mutationFn:async a=>{const{error:s}=await k.from("user_roles").delete().eq("id",a);if(s)throw s},onSuccess:()=>{t.invalidateQueries({queryKey:["admins"]}),M.success("ÐŸÑ€Ð°Ð²Ð° Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð° ÑƒÐ´Ð°Ð»ÐµÐ½Ñ‹")},onError:a=>{M.error(a.message)}})}const Bo=Be().email("ÐÐµÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ñ‹Ð¹ email");function Ho(){const{isOwner:t}=fe(),{data:a=[]}=Ko(),s=Vo(),r=qo(),[n,o]=l.useState("");if(!t)return null;const c=()=>{const i=Bo.safeParse(n);if(!i.success){M.error(i.error.errors[0].message);return}s.mutate(n),o("")};return e.jsxs(ue,{className:"bg-card border-border",children:[e.jsx(me,{className:"pb-2",children:e.jsxs(xe,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(nr,{className:"w-4 h-4 text-primary"}),"Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð°Ð¼Ð¸"]})}),e.jsxs(pe,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx($,{type:"email",placeholder:"Email Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ",value:n,onChange:i=>o(i.target.value),className:"bg-secondary border-border text-foreground"}),e.jsxs(w,{size:"sm",onClick:c,disabled:s.isPending,children:[e.jsx(ss,{className:"w-4 h-4 mr-1"}),"ÐÐ°Ð·Ð½Ð°Ñ‡Ð¸Ñ‚ÑŒ"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Ð¢ÐµÐºÑƒÑ‰Ð¸Ðµ Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ñ‹:"}),a.length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:"ÐÐµÑ‚ Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð¾Ð²"}):e.jsx("div",{className:"space-y-1",children:a.map(i=>e.jsxs("div",{className:"flex items-center justify-between text-sm py-1 px-2 bg-secondary/50 rounded",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:i.email}),e.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded ${i.role==="owner"?"bg-primary/20 text-primary":"bg-muted text-muted-foreground"}`,children:i.role==="owner"?"Owner":"Admin"})]}),i.role!=="owner"&&e.jsx(w,{variant:"ghost",size:"icon",className:"h-6 w-6 text-destructive",onClick:()=>r.mutate(i.id),children:e.jsx(Ce,{className:"w-3 h-3"})})]},i.id))})]})]})]})}function Wo(){const{data:t}=Se(),{data:a=[]}=Qe((t==null?void 0:t.id)??null),{data:s=[]}=xt(),r=a[0],n=r?s.filter(o=>o.tour_id===r.id).slice(0,6):[];return n.length===0?null:e.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-r from-pitch/20 via-pitch/10 to-pitch/20 border-y border-primary/30",children:[e.jsx("div",{className:"absolute inset-0 bg-[linear-gradient(90deg,transparent_0%,hsl(var(--primary)/0.05)_50%,transparent_100%)] animate-shimmer"}),e.jsx("div",{className:"relative py-3",children:e.jsxs("div",{className:"flex items-center gap-4 animate-scroll-left",children:[e.jsxs("div",{className:"flex items-center gap-2 shrink-0 px-4 border-r border-primary/30",children:[e.jsx(es,{className:"w-4 h-4 text-accent"}),e.jsxs("span",{className:"font-display text-sm text-accent",children:["Ð¢Ð£Ð  ",r==null?void 0:r.number]})]}),e.jsx("div",{className:"flex gap-4 sm:gap-8 items-center",children:[...n,...n].map((o,c)=>e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 shrink-0",children:[e.jsx("span",{className:"text-xs sm:text-sm font-medium text-foreground/80 max-w-[60px] sm:max-w-none truncate",children:o.home_team.name}),e.jsxs("span",{className:"font-display font-bold text-sm sm:text-lg match-score whitespace-nowrap",children:[o.home_score,":",o.away_score]}),e.jsx("span",{className:"text-xs sm:text-sm font-medium text-foreground/80 max-w-[60px] sm:max-w-none truncate",children:o.away_team.name}),e.jsx("span",{className:"text-muted-foreground/50 mx-2 sm:mx-4",children:"â€¢"})]},`${o.id}-${c}`))})]})})]})}const Qo="/HFC/assets/futsal-field-bg-DIaJKxAr.jpg",Yo=l.memo(or),Xo=l.memo(Wo),Zo=l.memo(Rr),Jo=l.memo(Ir),el=l.memo(Ar),tl=l.memo(so),sl=l.memo(vo),al=l.memo(bo),rl=l.memo(Co),nl=l.memo(So),ol=l.memo(Po),ll=l.memo(Eo),cl=l.memo(Uo),il=l.memo(Ho),_l=()=>{const{isAdmin:t,isOwner:a}=fe(),{data:s}=Se(),{data:r=[]}=Qe((s==null?void 0:s.id)??null),[n,o]=l.useState(null);l.useEffect(()=>{r.length>0&&!n&&o(r[0].id)},[r,n]),l.useEffect(()=>{o(null)},[s==null?void 0:s.id]);const c=l.useMemo(()=>r.find(i=>i.id===n),[r,n]);return e.jsxs("div",{className:"min-h-screen bg-background relative",children:[e.jsx("div",{className:"fixed inset-0 z-0 opacity-[0.03] pointer-events-none",style:{backgroundImage:`url(${Qo})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}}),e.jsxs("div",{className:"relative z-10",children:[e.jsx(Yo,{}),e.jsx(Xo,{}),e.jsxs("main",{className:"container mx-auto px-4 py-8 space-y-8",children:[e.jsxs("div",{className:"text-center space-y-3 hero-gradient py-8",children:[e.jsxs("h1",{className:"text-4xl md:text-5xl font-display font-bold text-foreground tracking-wide",children:["HFC ",e.jsx("span",{className:"gradient-text",children:"Football Stats"})]}),e.jsx("p",{className:"text-muted-foreground text-lg",children:"Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ° ÐºÐ¾Ð¼Ð°Ð½Ð´ Ð¸ Ð¸Ð³Ñ€Ð¾ÐºÐ¾Ð²"})]}),e.jsx("section",{children:e.jsx(Zo,{})}),c&&e.jsx("section",{children:e.jsx(el,{tourId:n,mvpPlayerId:c.mvp_player_id,tourNumber:c.number})}),s&&e.jsx("section",{className:"flex items-center justify-between",children:e.jsx(Jo,{selectedTourId:n,onTourChange:o})}),e.jsx("section",{className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4 lg:grid-cols-2",children:[e.jsx(tl,{tourId:n}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(sl,{tourId:n,tourNumber:c==null?void 0:c.number}),e.jsx(al,{tourId:n})]})]})}),(c==null?void 0:c.video_url)&&e.jsx("section",{children:e.jsx(ll,{videoUrl:c.video_url,tourNumber:c.number})}),e.jsx("section",{children:e.jsx(ol,{tourId:n})}),e.jsx("section",{className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4 lg:grid-cols-2",children:[e.jsx(rl,{}),e.jsx(nl,{})]})}),t&&e.jsxs("section",{className:"space-y-4 pt-8 border-t border-border",children:[e.jsx(cl,{tourId:n}),a&&e.jsx("div",{className:"max-w-md",children:e.jsx(il,{})})]})]}),e.jsx("footer",{className:"border-t border-border py-6 mt-12",children:e.jsx("div",{className:"container mx-auto px-4 text-center text-sm text-muted-foreground",children:e.jsxs("p",{children:["HFC Football Stats Â© ",new Date().getFullYear()]})})})]})]})};export{_l as default};
