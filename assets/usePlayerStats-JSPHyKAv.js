import{k as u,e as i}from"./avatar-D4j1ytug.js";import{s as a,a as o,b as n}from"./index-SMX7-DzB.js";function d(e){return u({queryKey:["tours","season",e],queryFn:async()=>{if(!e)return[];const{data:r,error:t}=await a.from("tours").select("*").eq("season_id",e).order("number",{ascending:!1});if(t)throw t;return r},enabled:!!e})}function f(){const e=o();return i({mutationFn:async r=>{const{data:t}=await a.from("tours").select("number").eq("season_id",r).order("number",{ascending:!1}).limit(1),s=t&&t.length>0?t[0].number+1:1,{data:y,error:c}=await a.from("tours").insert({number:s,season_id:r}).select().single();if(c)throw c;return y},onSuccess:()=>{e.invalidateQueries({queryKey:["tours"]}),e.invalidateQueries({queryKey:["current-tour"]}),n.success("Новый тур создан")},onError:r=>{n.error(r.message)}})}function h(e){return u({queryKey:["matches",e],queryFn:async()=>{if(!e)return[];const{data:r,error:t}=await a.from("matches").select(`
          *,
          home_team:teams!matches_home_team_id_fkey(id, name),
          away_team:teams!matches_away_team_id_fkey(id, name)
        `).eq("tour_id",e).order("created_at");if(t)throw t;return r},enabled:!!e})}function q(){return u({queryKey:["all-matches"],queryFn:async()=>{const{data:e,error:r}=await a.from("matches").select(`
          *,
          home_team:teams!matches_home_team_id_fkey(id, name),
          away_team:teams!matches_away_team_id_fkey(id, name)
        `).order("created_at");if(r)throw r;return e}})}function _(){const e=o();return i({mutationFn:async r=>{const{data:t,error:s}=await a.from("matches").insert(r).select().single();if(s)throw s;return t},onSuccess:()=>{e.invalidateQueries({queryKey:["matches"]}),e.invalidateQueries({queryKey:["all-matches"]}),n.success("Матч добавлен")},onError:r=>{n.error(r.message)}})}function w(){const e=o();return i({mutationFn:async r=>{const{error:t}=await a.from("matches").delete().eq("id",r);if(t)throw t},onSuccess:()=>{e.invalidateQueries({queryKey:["matches"]}),e.invalidateQueries({queryKey:["all-matches"]}),n.success("Матч удалён")},onError:r=>{n.error(r.message)}})}function p(e){return u({queryKey:["player-stats",e],queryFn:async()=>{if(!e)return[];const{data:r,error:t}=await a.from("player_stats").select(`
          *,
          player:players(id, name, team_id)
        `).eq("match_id",e);if(t)throw t;return r},enabled:!!e})}function K(){return u({queryKey:["player-stats-with-subs"],queryFn:async()=>{const{data:e,error:r}=await a.from("player_stats").select(`
          *,
          player:players(id, name, team_id),
          match:matches(tour_id)
        `);if(r)throw r;const{data:t,error:s}=await a.from("tour_player_substitutions").select("*");if(s)throw s;return{stats:e||[],substitutions:t||[]}}})}function b(e){return u({queryKey:["player-stats-tour",e],queryFn:async()=>{if(!e)return[];const{data:r,error:t}=await a.from("player_stats").select(`
          *,
          player:players(id, name, team_id),
          match:matches!inner(tour_id)
        `).eq("match.tour_id",e);if(t)throw t;return r},enabled:!!e})}function Q(){const e=o();return i({mutationFn:async r=>{const{data:t,error:s}=await a.from("player_stats").insert(r).select().single();if(s)throw s;return t},onSuccess:()=>{e.invalidateQueries({queryKey:["player-stats"]}),e.invalidateQueries({queryKey:["all-player-stats"]}),e.invalidateQueries({queryKey:["player-stats-tour"]}),n.success("Статистика добавлена")},onError:r=>{n.error(r.message)}})}function v(){const e=o();return i({mutationFn:async({id:r,...t})=>{const{data:s,error:y}=await a.from("player_stats").update(t).eq("id",r).select().single();if(y)throw y;return s},onSuccess:()=>{e.invalidateQueries({queryKey:["player-stats"]}),e.invalidateQueries({queryKey:["all-player-stats"]}),e.invalidateQueries({queryKey:["player-stats-tour"]}),n.success("Статистика обновлена")},onError:r=>{n.error(r.message)}})}function g(){const e=o();return i({mutationFn:async r=>{const{error:t}=await a.from("player_stats").delete().eq("id",r);if(t)throw t},onSuccess:()=>{e.invalidateQueries({queryKey:["player-stats"]}),e.invalidateQueries({queryKey:["all-player-stats"]}),e.invalidateQueries({queryKey:["player-stats-tour"]}),n.success("Статистика удалена")},onError:r=>{n.error(r.message)}})}export{f as a,h as b,p as c,Q as d,v as e,g as f,b as g,q as h,K as i,_ as j,w as k,d as u};
