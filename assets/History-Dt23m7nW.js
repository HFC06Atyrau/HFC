import{c as I,s as g,r as p,j as e,u as C,B as P}from"./index-DmR0dP9w.js";import{k,g as _,u as M,H as A,q as E,d as B,f as F}from"./avatar-D7jM04Y9.js";import{u as H,b as q,g as L}from"./usePlayerStats-CJcUe3gK.js";import{u as R}from"./useTourTeams-D9TdrANi.js";import{S as w,a as v,b as S,c as T,d as D,j as N,k as V,D as y,g as b,i as $}from"./DreamTeamSelector-BMpnS8Rb.js";import"./trophy-czA6I5-V.js";import"./index-C9lYhDSe.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=I("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);function O(a){return k({queryKey:["matches-by-season",a],queryFn:async()=>{if(!a)return[];const{data:c,error:o}=await g.from("tours").select("id").eq("season_id",a);if(o)throw o;if(!c||c.length===0)return[];const d=c.map(r=>r.id),{data:l,error:t}=await g.from("matches").select(`
          *,
          home_team:teams!matches_home_team_id_fkey(id, name, color),
          away_team:teams!matches_away_team_id_fkey(id, name, color)
        `).in("tour_id",d).order("created_at");if(t)throw t;return l},enabled:!!a})}function K(a,c){let o=0,d=0,l=0,t=0,r=0;return c.forEach(s=>{s.home_team_id===a.id?(t+=s.home_score,r+=s.away_score,s.home_score>s.away_score?o++:s.home_score===s.away_score?d++:l++):s.away_team_id===a.id&&(t+=s.away_score,r+=s.home_score,s.away_score>s.home_score?o++:s.away_score===s.home_score?d++:l++)}),{teamId:a.id,teamName:a.name,teamColor:a.color??"black",played:o+d+l,won:o,drawn:d,lost:l,goalsFor:t,goalsAgainst:r,goalDiff:t-r,points:o*3+d}}const Q=a=>{switch(a){case"red":return"text-team-red";case"blue":return"text-team-blue";case"green":return"text-team-green";case"black":return"text-foreground";default:return"text-muted-foreground"}};function U({seasonId:a}){const{data:c=[]}=_(),{data:o=[],isLoading:d}=O(a),l=p.useMemo(()=>c.map(t=>K(t,o)).filter(t=>t.played>0).sort((t,r)=>r.points-t.points||r.goalDiff-t.goalDiff),[c,o]);return d?e.jsx("div",{className:"stat-card animate-pulse h-48"}):l.length===0?e.jsxs("div",{className:"stat-card",children:[e.jsx("h3",{className:"text-lg font-bold text-foreground font-mono mb-4",children:"–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–º–∞–Ω–¥ —Å–µ–∑–æ–Ω–∞"}),e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è"})]}):e.jsxs("div",{className:"stat-card",children:[e.jsx("h3",{className:"text-lg font-bold text-foreground font-mono mb-4",children:"–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–º–∞–Ω–¥ —Å–µ–∑–æ–Ω–∞"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-border text-muted-foreground",children:[e.jsx("th",{className:"text-left py-2 px-2",children:"#"}),e.jsx("th",{className:"text-left py-2 px-2",children:"–ö–æ–º–∞–Ω–¥–∞"}),e.jsx("th",{className:"text-center py-2 px-1",children:"–ò"}),e.jsx("th",{className:"text-center py-2 px-1",children:"–í"}),e.jsx("th",{className:"text-center py-2 px-1",children:"–ù"}),e.jsx("th",{className:"text-center py-2 px-1",children:"–ü"}),e.jsx("th",{className:"text-center py-2 px-1",children:"–ì–ó"}),e.jsx("th",{className:"text-center py-2 px-1",children:"–ì–ü"}),e.jsx("th",{className:"text-center py-2 px-1",children:"–†–∞–∑–Ω"}),e.jsx("th",{className:"text-center py-2 px-1 text-primary",children:"–û—á–∫–∏"})]})}),e.jsx("tbody",{children:l.map((t,r)=>e.jsxs("tr",{className:"border-b border-border/50 hover:bg-secondary/50 transition-colors",children:[e.jsx("td",{className:"py-2 px-2 text-muted-foreground",children:r+1}),e.jsx("td",{className:`py-2 px-2 font-medium ${Q(t.teamColor)}`,children:t.teamName}),e.jsx("td",{className:"text-center py-2 px-1 font-mono",children:t.played}),e.jsx("td",{className:"text-center py-2 px-1 font-mono",children:t.won}),e.jsx("td",{className:"text-center py-2 px-1 font-mono",children:t.drawn}),e.jsx("td",{className:"text-center py-2 px-1 font-mono",children:t.lost}),e.jsx("td",{className:"text-center py-2 px-1 font-mono",children:t.goalsFor}),e.jsx("td",{className:"text-center py-2 px-1 font-mono",children:t.goalsAgainst}),e.jsxs("td",{className:"text-center py-2 px-1 font-mono",children:[t.goalDiff>0?"+":"",t.goalDiff]}),e.jsx("td",{className:"text-center py-2 px-1 font-mono font-bold text-primary",children:t.points})]},t.teamId))})]})})]})}function Y(a,c,o,d){let l=0,t=0,r=0,s=0,x=0;return d.forEach(m=>{m.home_team_id===a?(s+=m.home_score,x+=m.away_score,m.home_score>m.away_score?l++:m.home_score===m.away_score?t++:r++):m.away_team_id===a&&(s+=m.away_score,x+=m.home_score,m.away_score>m.home_score?l++:m.away_score===m.home_score?t++:r++)}),{teamId:a,teamName:c,color:o,played:l+t+r,won:l,drawn:t,lost:r,goalsFor:s,goalsAgainst:x,goalDiff:s-x,points:l*3+t}}function G({tour:a}){const{data:c=[]}=b(a.id,"dream"),{data:o=[]}=b(a.id,"anti"),d=$(),l=p.useMemo(()=>{const r=new Array(5).fill("");return c.forEach(s=>{s.position>=1&&s.position<=5&&(r[s.position-1]=s.player_id)}),r},[c]),t=p.useMemo(()=>{const r=new Array(5).fill("");return o.forEach(s=>{s.position>=1&&s.position<=5&&(r[s.position-1]=s.player_id)}),r},[o]);return e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 mt-6",children:[e.jsx(y,{title:"–°–±–æ—Ä–Ω–∞—è —Ç—É—Ä–∞",type:"dream",selectedPlayerIds:l,onSave:r=>d.mutate({tourId:a.id,teamType:"dream",playerIds:r.filter(Boolean)}),isPending:d.isPending}),e.jsx(y,{title:"–ê–Ω—Ç–∏—Å–±–æ—Ä–Ω–∞—è —Ç—É—Ä–∞",type:"anti",selectedPlayerIds:t,onSave:r=>d.mutate({tourId:a.id,teamType:"anti",playerIds:r.filter(Boolean)}),isPending:d.isPending})]})}function J({season:a}){const{data:c=[]}=N(a.id,"dream"),{data:o=[]}=N(a.id,"anti"),d=V(),l=p.useMemo(()=>{const r=new Array(5).fill("");return c.forEach(s=>{s.position>=1&&s.position<=5&&(r[s.position-1]=s.player_id)}),r},[c]),t=p.useMemo(()=>{const r=new Array(5).fill("");return o.forEach(s=>{s.position>=1&&s.position<=5&&(r[s.position-1]=s.player_id)}),r},[o]);return e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 mt-6",children:[e.jsx(y,{title:"–°–±–æ—Ä–Ω–∞—è —Å–µ–∑–æ–Ω–∞",type:"dream",selectedPlayerIds:l,onSave:r=>d.mutate({seasonId:a.id,teamType:"dream",playerIds:r.filter(Boolean)}),isPending:d.isPending}),e.jsx(y,{title:"–ê–Ω—Ç–∏—Å–±–æ—Ä–Ω–∞—è —Å–µ–∑–æ–Ω–∞",type:"anti",selectedPlayerIds:t,onSave:r=>d.mutate({seasonId:a.id,teamType:"anti",playerIds:r.filter(Boolean)}),isPending:d.isPending})]})}function W({tour:a}){const{data:c=[]}=R(a.id),{data:o=[]}=_(),{data:d=[]}=q(a.id),{data:l=[]}=L(a.id),{data:t=[]}=F(),r=p.useMemo(()=>c.map(n=>{const i=o.find(h=>h.id===n.team_id),u=(i==null?void 0:i.color)??"black";return Y(n.team_id,n.team.name,u,d)}).sort((n,i)=>i.points-n.points||i.goalDiff-n.goalDiff),[c,d,o]),s=p.useMemo(()=>{const n=new Map;return l.forEach(i=>{const u=n.get(i.player_id);if(u)u.goals+=i.goals,u.assists+=i.assists,u.yellowCards+=i.yellow_cards,u.redCards+=i.red_cards;else{const h=t.find(j=>j.id===i.player_id),f=o.find(j=>j.id===(h==null?void 0:h.team_id));n.set(i.player_id,{playerId:i.player_id,playerName:(h==null?void 0:h.name)??"Unknown",teamName:(f==null?void 0:f.name)??"",teamColor:(f==null?void 0:f.color)??"black",goals:i.goals,assists:i.assists,yellowCards:i.yellow_cards,redCards:i.red_cards})}}),Array.from(n.values()).sort((i,u)=>u.goals-i.goals||u.assists-i.assists)},[l,t,o]),x=n=>{switch(n){case"red":return"bg-team-red px-2 py-0.5 rounded";case"blue":return"bg-team-blue px-2 py-0.5 rounded";case"green":return"bg-team-green px-2 py-0.5 rounded";case"black":return"bg-team-black text-foreground px-2 py-0.5 rounded";default:return""}},m=n=>{switch(n){case"red":return"text-team-red";case"blue":return"text-team-blue";case"green":return"text-team-green";case"black":return"text-foreground";default:return"text-muted-foreground"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs("div",{className:"stat-card",children:[e.jsx("h3",{className:"text-lg font-bold text-foreground font-mono mb-4",children:"–¢–∞–±–ª–∏—Ü–∞ –∫–æ–º–∞–Ω–¥"}),r.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-border text-muted-foreground",children:[e.jsx("th",{className:"text-left py-2 px-2",children:"–ö–æ–º–∞–Ω–¥–∞"}),e.jsx("th",{className:"text-center py-2 px-1",children:"–ò"}),e.jsx("th",{className:"text-center py-2 px-1",children:"–í"}),e.jsx("th",{className:"text-center py-2 px-1",children:"–ù"}),e.jsx("th",{className:"text-center py-2 px-1",children:"–ü"}),e.jsx("th",{className:"text-center py-2 px-1",children:"–ì–ó"}),e.jsx("th",{className:"text-center py-2 px-1",children:"–ì–ü"}),e.jsx("th",{className:"text-center py-2 px-1",children:"–†–∞–∑–Ω"}),e.jsx("th",{className:"text-center py-2 px-1 text-primary",children:"–û—á–∫–∏"})]})}),e.jsx("tbody",{children:r.map(n=>e.jsxs("tr",{className:"border-b border-border/50 transition-colors",children:[e.jsx("td",{className:"py-2 px-2 font-medium",children:e.jsx("span",{className:x(n.color),children:n.teamName})}),e.jsx("td",{className:"text-center py-2 px-1 font-mono",children:n.played}),e.jsx("td",{className:"text-center py-2 px-1 font-mono",children:n.won}),e.jsx("td",{className:"text-center py-2 px-1 font-mono",children:n.drawn}),e.jsx("td",{className:"text-center py-2 px-1 font-mono",children:n.lost}),e.jsx("td",{className:"text-center py-2 px-1 font-mono",children:n.goalsFor}),e.jsx("td",{className:"text-center py-2 px-1 font-mono",children:n.goalsAgainst}),e.jsxs("td",{className:"text-center py-2 px-1 font-mono",children:[n.goalDiff>0?"+":"",n.goalDiff]}),e.jsx("td",{className:"text-center py-2 px-1 font-mono font-bold text-primary",children:n.points})]},n.teamId))})]})}),d.length>0&&e.jsxs("div",{className:"mt-6 pt-4 border-t border-border",children:[e.jsx("h4",{className:"text-sm font-semibold text-muted-foreground mb-3",children:"–ú–∞—Ç—á–∏ —Ç—É—Ä–∞"}),e.jsx("div",{className:"space-y-2",children:d.map(n=>e.jsxs("div",{className:"flex items-center justify-between py-2 px-3 bg-secondary/30 rounded-lg text-sm",children:[e.jsx("span",{className:"flex-1 text-right truncate font-medium",children:n.home_team.name}),e.jsxs("span",{className:"mx-3 font-mono font-bold text-primary text-lg",children:[n.home_score,":",n.away_score]}),e.jsx("span",{className:"flex-1 text-left truncate font-medium",children:n.away_team.name})]},n.id))})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("h3",{className:"text-lg font-bold text-foreground font-mono mb-4",children:"–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä–æ–∫–æ–≤"}),s.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-border text-muted-foreground",children:[e.jsx("th",{className:"text-left py-2 px-2",children:"#"}),e.jsx("th",{className:"text-left py-2 px-2",children:"–ò–≥—Ä–æ–∫"}),e.jsx("th",{className:"text-left py-2 px-2",children:"–ö–æ–º–∞–Ω–¥–∞"}),e.jsx("th",{className:"text-center py-2 px-1",children:"‚öΩ"}),e.jsx("th",{className:"text-center py-2 px-1",children:"üÖ∞Ô∏è"}),e.jsx("th",{className:"text-center py-2 px-1",children:"üü®"}),e.jsx("th",{className:"text-center py-2 px-1",children:"üü•"})]})}),e.jsx("tbody",{children:s.map((n,i)=>e.jsxs("tr",{className:"border-b border-border/50 hover:bg-secondary/50 transition-colors",children:[e.jsx("td",{className:"py-2 px-2 text-muted-foreground",children:i+1}),e.jsx("td",{className:"py-2 px-2 font-medium",children:n.playerName}),e.jsx("td",{className:`py-2 px-2 ${m(n.teamColor)}`,children:n.teamName}),e.jsx("td",{className:"text-center py-2 px-1 font-mono font-bold text-primary",children:n.goals}),e.jsx("td",{className:"text-center py-2 px-1 font-mono",children:n.assists}),e.jsx("td",{className:"text-center py-2 px-1 font-mono",children:n.yellowCards}),e.jsx("td",{className:"text-center py-2 px-1 font-mono",children:n.redCards})]},n.playerId))})]})})]})]}),e.jsx(G,{tour:a})]})}function X({season:a}){const{isAdmin:c}=C(),{data:o=[],isLoading:d}=H(a.id),l=B(),[t,r]=p.useState(null),s=p.useMemo(()=>t&&o.find(x=>x.id===t)||null,[o,t]);return d?e.jsx("div",{className:"stat-card animate-pulse h-64"}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(U,{seasonId:a.id}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[o.length>0&&e.jsxs(w,{value:t||"",onValueChange:x=>r(x),children:[e.jsx(v,{className:"w-[180px]",children:e.jsx(S,{placeholder:"–í—ã–±–µ—Ä–∏—Ç–µ —Ç—É—Ä"})}),e.jsx(T,{children:o.map(x=>e.jsxs(D,{value:x.id,children:["–¢—É—Ä ",x.number]},x.id))})]}),c&&!a.is_current&&e.jsxs(P,{variant:"outline",size:"sm",onClick:()=>l.mutate(a.id),disabled:l.isPending,children:[e.jsx(z,{className:"w-4 h-4 mr-1"}),"–°–¥–µ–ª–∞—Ç—å —Ç–µ–∫—É—â–∏–º"]})]}),o.length===0?e.jsx("div",{className:"stat-card text-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:"–í —ç—Ç–æ–º —Å–µ–∑–æ–Ω–µ –Ω–µ—Ç —Ç—É—Ä–æ–≤"})}):s?e.jsx(W,{tour:s}):e.jsx("div",{className:"stat-card text-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:"–í—ã–±–µ—Ä–∏—Ç–µ —Ç—É—Ä –∏–∑ —Å–ø–∏—Å–∫–∞"})}),e.jsx(J,{season:a})]})}const oe=()=>{const{data:a=[],isLoading:c}=M(),[o,d]=p.useState(null),l=p.useMemo(()=>a.sort((s,x)=>new Date(x.created_at).getTime()-new Date(s.created_at).getTime()),[a]),t=p.useMemo(()=>{var x;const s=l.filter(m=>!m.is_current);return s.length>0?s[0].id:((x=l[0])==null?void 0:x.id)??null},[l]);p.useEffect(()=>{!o&&t&&d(t)},[t,o]);const r=p.useMemo(()=>o&&l.find(s=>s.id===o)||null,[l,o]);return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(A,{}),e.jsxs("main",{className:"container mx-auto px-4 py-8 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center",children:e.jsx(E,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground font-mono",children:"–ò—Å—Ç–æ—Ä–∏—è —Å–µ–∑–æ–Ω–æ–≤"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"–ü—Ä–æ—Å–º–æ—Ç—Ä –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Å–µ–∑–æ–Ω–æ–≤"})]})]}),!c&&l.length>0&&e.jsxs(w,{value:o||"",onValueChange:s=>d(s),children:[e.jsx(v,{className:"w-[220px]",children:e.jsx(S,{placeholder:"–í—ã–±–µ—Ä–∏—Ç–µ —Å–µ–∑–æ–Ω"})}),e.jsx(T,{children:l.map(s=>e.jsxs(D,{value:s.id,children:[s.name," ",s.is_current&&"(—Ç–µ–∫—É—â–∏–π)"]},s.id))})]})]}),c?e.jsx("div",{className:"stat-card animate-pulse h-64"}):l.length===0?e.jsx("div",{className:"stat-card text-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:"–°–µ–∑–æ–Ω–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç"})}):r?e.jsx(X,{season:r}):e.jsx("div",{className:"stat-card text-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:"–í—ã–±–µ—Ä–∏—Ç–µ —Å–µ–∑–æ–Ω –∏–∑ —Å–ø–∏—Å–∫–∞ –≤—ã—à–µ"})})]}),e.jsx("footer",{className:"border-t border-border py-6 mt-12",children:e.jsx("div",{className:"container mx-auto px-4 text-center text-sm text-muted-foreground",children:e.jsxs("p",{children:["HFC Football Stats ¬© ",new Date().getFullYear()]})})})]})};export{oe as default};
